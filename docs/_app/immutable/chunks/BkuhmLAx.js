import{t as dt,a as W,n as xt,c as Zt,b as Jt}from"./tV2K8-t_.js";import{i as Qt}from"./ByiRlZ4K.js";import{o as te}from"./uz48rOOJ.js";import{v as It,p as ee,a3 as K,a4 as oe,_ as z,a as ne,c as t,m as $,k as p,X as gt,a5 as $t,$ as E,a1 as g,a0 as F,Z as lt,d as h}from"./WXaAkZrh.js";import{e as w,s as C}from"./F6O-0aNN.js";import{i as it}from"./Bj7JGMQR.js";import{a as se,e as Bt,s as a,i as Rt,r as ae}from"./DrBpmEm4.js";import{p as re}from"./B3nBOueu.js";function ct(N,Z,L,G){var B=N.__style;if(It||B!==Z){var D=se(Z);(!It||D!==N.getAttribute("style"))&&(D==null?N.removeAttribute("style"):N.style.cssText=D),N.__style=Z}return G}var le=xt('<line class="time-marker-line svelte-42xpdj"></line><text text-anchor="middle" class="time-marker svelte-42xpdj"> </text>',1),ie=xt('<g role="button" tabindex="0" class="svelte-42xpdj"><text text-anchor="middle" class="book-title svelte-42xpdj"> </text><circle class="book-dot svelte-42xpdj"></circle><line stroke="#555" stroke-width="0.5" stroke-dasharray="2 2"></line></g>'),ce=xt('<g role="button" tabindex="0" class="svelte-42xpdj"><text text-anchor="middle" class="person-name svelte-42xpdj"> </text><rect class="person-bar svelte-42xpdj"></rect><line stroke="#555" stroke-width="0.5" stroke-dasharray="2 2"></line></g>'),de=dt(" <br> ",1),he=dt(" <br> ",1),ue=dt('<div class="image-popup svelte-42xpdj"><img class="svelte-42xpdj"> <h4 class="svelte-42xpdj"> </h4> <p class="svelte-42xpdj"><!></p> <button style="position: absolute; top: 5px; right: 5px; background: none; border: none; color: white; cursor: pointer; font-size: 16px;">Ã—</button></div>'),fe=dt('<div class="timeline-container svelte-42xpdj" role="application" aria-label="Interactive timeline visualization - click and drag to pan, scroll to zoom, pinch to zoom on mobile"><div class="timeline-content svelte-42xpdj"><svg class="svelte-42xpdj"><rect x="0" y="0" fill="#17191C"></rect><!><line class="main-timeline svelte-42xpdj"></line><!></svg></div> <!></div>');function we(N,Z){ee(Z,!1);const L=$(),G=$(),B=$(),D=$(),P=$(),bt=$();let J=re(Z,"items",8);const tt=60,X=800,R=8,ht=40,nt=90,_t=10,ut=1.2,ft=25,yt=6;function wt(e){return e.title!==void 0&&e.published!==void 0}function Mt(e){return e.title!==void 0&&e.created!==void 0}function kt(e){return wt(e)||Mt(e)}function Q(e){return(e-t(L))*ut+tt}function V(e){return e===0?"0":e<0?`${Math.abs(e)}BC`:`${e}`}let c=$(null),pt=$(0),vt=$(0),et=!1,Yt=0,Tt=0,Dt=0,St=0,i,st=0,At=1,m=$(1);te(()=>{if(i=document.querySelector(".timeline-container"),i){const e=i.querySelector(".timeline-content");if(e){const o=i.clientWidth/t(B),s=i.clientHeight/t(D),n=Math.min(o,s)*.95;p(m,Math.max(.1,Math.min(50,n))),e.style.transform=`scale(${t(m)})`,e.style.transformOrigin="top left";const r=t(B)*t(m),l=t(D)*t(m);i.scrollLeft=Math.max(0,(r-i.clientWidth)/2),i.scrollTop=Math.max(0,(l-i.clientHeight)/2)}}});function Ot(e){e.target.closest(".person-bar, .book-dot, .person-name, .book-title, .image-popup")||(t(c)&&p(c,null),et=!0,Yt=e.pageX-i.offsetLeft,Tt=e.pageY-i.offsetTop,Dt=i.scrollLeft,St=i.scrollTop,i.style.cursor="grabbing")}function Wt(e){if(!et)return;e.preventDefault();const o=e.pageX-i.offsetLeft,s=e.pageY-i.offsetTop,n=(o-Yt)*1.5,r=(s-Tt)*1.5;i.scrollLeft=Dt-n,i.scrollTop=St-r}function Ct(){et=!1,i&&(i.style.cursor="grab")}function Lt(){et&&(et=!1,i&&(i.style.cursor="grab"))}function qt(e){e.preventDefault();const n=1+-e.deltaY*3e-4,r=Math.max(.1,Math.min(50,t(m)*n));if(r===t(m))return;const l=i.getBoundingClientRect(),M=e.clientX-l.left,k=e.clientY-l.top,A=i.scrollLeft,Y=i.scrollTop,x=(A+M)/t(m),u=(Y+k)/t(m);p(m,r);const d=i==null?void 0:i.querySelector(".timeline-content");d&&(d.style.transform=`scale(${t(m)})`,d.style.transformOrigin="top left"),i.scrollLeft=x*r-M,i.scrollTop=u*r-k}function Et(e){const o=e[0].clientX-e[1].clientX,s=e[0].clientY-e[1].clientY;return Math.sqrt(o*o+s*s)}function Ht(e){e.touches.length===2&&(e.preventDefault(),st=Et(e.touches),At=t(m))}function zt(e){if(e.touches.length===2&&st>0){e.preventDefault();const s=Et(e.touches)/st,n=Math.max(.1,Math.min(50,At*s));p(m,n);const r=i==null?void 0:i.querySelector(".timeline-content");r&&(r.style.transform=`scale(${t(m)})`,r.style.transformOrigin="top left")}}function Nt(e){e.touches.length<2&&(st=0)}function Ft(e,o){p(c,e);const s=Xt(o.clientX,o.clientY);p(pt,s.x),p(vt,s.y),o.stopPropagation()}function Pt(e,o){if(o.key==="Enter"||o.key===" "){o.preventDefault(),p(c,e);const s=o.target.getBoundingClientRect(),n=Xt(s.left+s.width/2,s.top+s.height/2);p(pt,n.x),p(vt,n.y)}}function Xt(e,o){const s={width:220,height:300},n=20;let r=e,l=o;return r+s.width/2>window.innerWidth-n&&(r=window.innerWidth-s.width/2-n),r-s.width/2<n&&(r=s.width/2+n),l+s.height/2>window.innerHeight-n&&(l=window.innerHeight-s.height/2-n),l-s.height/2<n&&(l=s.height/2+n),{x:r,y:l}}K(()=>gt(J()),()=>{p(L,Math.floor(Math.min(...J().map(e=>e.born||e.published||e.created||0))/100)*100-100)}),K(()=>gt(J()),()=>{p(G,Math.ceil(Math.max(...J().map(e=>e.died||e.created||e.published||new Date().getFullYear()||0))/100)*100)}),K(()=>(t(G),t(L)),()=>{p(B,(t(G)-t(L))*ut+tt*2)}),K(()=>{},()=>{p(D,X+tt*3+ft*2*(R+ht))}),K(()=>gt(J()),()=>{p(P,[...J()].sort((e,o)=>(e.born||e.published||e.created||0)-(o.born||o.published||o.created||0)))}),K(()=>(t(G),t(L)),()=>{p(bt,Array.from({length:Math.ceil((t(G)-t(L))/100)+1},(e,o)=>Math.floor(t(L)/100)*100+o*100))}),K(()=>t(P),()=>{const e=[],o=[];for(let n=0;n<t(P).length;n++)n%2===0?(e.push(t(P)[n]),$t(P,t(P)[n].placement="top")):(o.push(t(P)[n]),$t(P,t(P)[n].placement="bottom"));function s(n){n.sort((r,l)=>(r.born||r.published||r.created||0)-(l.born||l.published||l.created||0));for(let r=0;r<n.length;r++){const l=n[r],M=l.born||l.published||l.created||0,k=l.died||l.created||l.published||new Date().getFullYear();let A=!1,Y=1;for(;!A&&Y<=ft;)n.some((u,d)=>{var _,v;if(d>=r||u.row!==Y)return!1;const b=u.born||u.published||u.created||0,f=u.died||u.created||u.published||new Date().getFullYear();if(kt(l)&&kt(u)){const y=(((_=l.title)==null?void 0:_.length)||0)*6,j=(((v=u.title)==null?void 0:v.length)||0)*6,T=Math.max(y,j),O=Math.max(50,T/ut);return Math.abs(M-b)<O}return M<=f+70&&k>=b-70})?Y++:(l.row=Y,A=!0);A||(l.row=ft)}}s(e),s(o)}),oe(),Qt();var S=fe(),at=E(S),rt=E(at),mt=E(rt),jt=g(mt);Bt(jt,1,()=>t(bt),Rt,(e,o)=>{var s=le(),n=lt(s);a(n,"y1",0);var r=g(n);a(r,"y",X-20);var l=E(r,!0);F(r),z((M,k,A,Y)=>{a(n,"x1",M),a(n,"x2",k),a(n,"y2",t(D)),a(r,"x",A),C(l,Y)},[()=>Q(t(o)),()=>Q(t(o)),()=>Q(t(o)),()=>V(t(o))],h),W(e,s)});var ot=g(jt);a(ot,"x1",tt),a(ot,"y1",X),a(ot,"y2",X);var Gt=g(ot);Bt(Gt,1,()=>t(P),Rt,(e,o)=>{var s=Zt();const n=h(()=>t(o).born||t(o).published||t(o).created||0),r=h(()=>wt(t(o))),l=h(()=>Mt(t(o))),M=h(()=>t(r)||t(l)),k=h(()=>t(M)?t(o).title:t(o).name);var A=lt(s);{var Y=u=>{var d=ie();const b=h(()=>Q(t(n))),f=h(()=>t(o).placement==="top"),_=h(()=>(t(o).row-1)*(R+ht)),v=h(()=>t(f)?X-nt-t(_)-R/2:X+nt+t(_)+R/2),y=h(()=>t(l)?"#FF6B9D":"#4A9EFF"),j=h(()=>t(l)?"{displayName} by {item.artist}, created {formatYear(yearValue)}":"{displayName} by {item.author}, published {formatYear(yearValue)}");var T=E(d),O=E(T,!0);F(T);var U=g(T);a(U,"r",yt);var I=g(U);F(d),z(()=>{a(d,"aria-label",t(j)),a(T,"x",t(b)),a(T,"y",t(v)+(t(f)?-16:_t+6)),ct(T,`fill: ${t(l)?"#FF6B9D":"#4A9EFF"}`),C(O,t(k)),a(U,"cx",t(b)),a(U,"cy",t(v)),ct(U,`fill: ${t(y)??""}; stroke: ${t(y)??""}`),a(I,"x1",t(b)),a(I,"y1",t(v)+(t(f)?yt:-6)),a(I,"x2",t(b)),a(I,"y2",X+(t(f)?-3:3))}),w("click",d,q=>Ft(t(o),q)),w("keydown",d,q=>Pt(t(o),q)),W(u,d)},x=u=>{var d=ce();const b=h(()=>t(o).died||new Date().getFullYear()),f=h(()=>Q(t(n))),_=h(()=>Q(t(b))),v=h(()=>Math.max(t(_)-t(f),5)),y=h(()=>t(o).placement==="top"),j=h(()=>(t(o).row-1)*(R+ht)),T=h(()=>t(y)?X-nt-t(j)-R:X+nt+t(j));var O=E(d),U=E(O,!0);F(O);var I=g(O);a(I,"height",R);var q=g(I);F(d),z((H,Kt)=>{a(d,"aria-label",`${t(k)??""}, ${H??""} to ${Kt??""}`),a(O,"x",t(f)+t(v)/2),a(O,"y",t(T)+(t(y)?-10:R+_t)),C(U,t(k)),a(I,"x",t(f)),a(I,"y",t(T)),a(I,"width",t(v)),a(q,"x1",t(f)+t(v)/2),a(q,"y1",t(T)+(t(y)?R:0)),a(q,"x2",t(f)+t(v)/2),a(q,"y2",X+(t(y)?-3:3))},[()=>{var H;return(H=t(c))!=null&&H.born?V(t(o).born):""},()=>t(o).died?V(t(o).died):"present"],h),w("click",d,H=>Ft(t(o),H)),w("keydown",d,H=>Pt(t(o),H)),W(u,d)};it(A,u=>{t(M)?u(Y):u(x,!1)})}W(e,s)}),F(rt),F(at);var Vt=g(at,2);{var Ut=e=>{var o=ue(),s=E(o),n=g(s,2),r=E(n,!0);F(n);var l=g(n,2),M=E(l);{var k=x=>{var u=de(),d=lt(u,!0),b=g(d,2);z(f=>{C(d,t(c).artist),C(b,` ${f??""}`)},[()=>V(t(c).created)],h),W(x,u)},A=(x,u)=>{{var d=f=>{var _=he(),v=lt(_,!0),y=g(v,2);z(j=>{C(v,t(c).author),C(y,` ${j??""}`)},[()=>V(t(c).published)],h),W(f,_)},b=f=>{var _=Jt();z((v,y,j)=>C(_,`${v??""} - 
          ${y??""}
          (${j??""} years)`),[()=>t(c).born?V(t(c).born):"",()=>t(c).died?V(t(c).died):"present",()=>t(c).died?Math.abs(t(c).died-t(c).born):Math.abs(new Date().getFullYear()-t(c).born)],h),W(f,_)};it(x,f=>{t(c).published?f(d):f(b,!1)},u)}};it(M,x=>{t(c).created?x(k):x(A,!1)})}F(l);var Y=g(l,2);F(o),z(x=>{ct(o,`left: ${t(pt)??""}px; top: ${t(vt)??""}px;`),a(s,"src",x),a(s,"alt",t(c).name||t(c).title),C(r,t(c).name||t(c).title)},[()=>ae(t(c).image)],h),w("click",Y,()=>p(c,null)),W(e,o)};it(Vt,e=>{t(c)&&e(Ut)})}F(S),z(()=>{ct(at,`width: ${t(B)*t(m)}px; height: ${t(D)*t(m)}px;`),a(rt,"width",t(B)),a(rt,"height",t(D)),a(mt,"width",t(B)),a(mt,"height",t(D)),a(ot,"x2",t(B)-tt)}),w("mousedown",S,Ot),w("mousemove",S,Wt),w("mouseup",S,Ct),w("mouseleave",S,Lt),w("wheel",S,qt),w("touchstart",S,Ht),w("touchmove",S,zt),w("touchend",S,Nt),W(N,S),ne()}export{we as T};
