import{t as he,a as S,n as pe,c as Le,b as Ce}from"./BIYvNW0b.js";import{i as We}from"./14nf3aC0.js";import{h as Te,p as Ge,o as He,a0 as H,a1 as Ne,X as N,a as qe,G as x,I as A,T as ce,x as e,a2 as Pe,Y as _,_ as g,Z as w,W as de,u as d}from"./CSOfU5Pt.js";import{e as E,s as q}from"./vckkWNzg.js";import{i as ue}from"./DBxt3fiE.js";import{t as ze,e as Ae,s as r,i as Ee,r as Ue}from"./Dm0SIGCO.js";import{p as Ke}from"./BWVsNKEK.js";function De($,z,D,B){var F=$.__style;if(Te||F!==z){var Y=ze(z);(!Te||Y!==$.getAttribute("style"))&&(Y==null?$.removeAttribute("style"):$.style.cssText=Y),$.__style=z}return B}var Ve=pe('<line class="time-marker-line svelte-1dewxud"></line><text text-anchor="middle" class="time-marker svelte-1dewxud"> </text>',1),Ze=pe('<g role="button" tabindex="0"><text text-anchor="middle" class="book-title svelte-1dewxud"> </text><circle class="book-dot svelte-1dewxud"></circle><line stroke="#555" stroke-width="0.5" stroke-dasharray="2 2"></line></g>'),je=pe('<g role="button" tabindex="0"><text text-anchor="middle" class="person-name svelte-1dewxud"> </text><rect class="person-bar svelte-1dewxud"></rect><line stroke="#555" stroke-width="0.5" stroke-dasharray="2 2"></line></g>'),Je=he(" <br> ",1),Qe=he('<div class="image-popup svelte-1dewxud"><img class="svelte-1dewxud"> <h4 class="svelte-1dewxud"> </h4> <p class="svelte-1dewxud"><!></p> <button style="position: absolute; top: 5px; right: 5px; background: none; border: none; color: white; cursor: pointer; font-size: 16px;">Ã—</button></div>'),et=he('<div class="timeline-container svelte-1dewxud" role="application" aria-label="Interactive timeline visualization - click and drag to pan"><div class="timeline-content svelte-1dewxud"><svg class="svelte-1dewxud"><rect x="0" y="0" fill="#17191C"></rect><!><line class="main-timeline svelte-1dewxud"></line><!></svg></div> <!></div>');function lt($,z){Ge(z,!1);const D=A(),B=A(),F=A(),Y=A(),m=A(),fe=A();let U=Ke(z,"items",8);const K=60,y=800,T=8,se=40,J=90,ve=10,xe=1.2,re=25,ge=6;function ae(o){return o.title!==void 0&&o.published!==void 0}function O(o){return(o-e(D))*xe+K}function L(o){return o===0?"0":o<0?`${Math.abs(o)}BC`:`${o}`}let c=A(null),ne=A(0),ie=A(0),V=!1,be=0,_e=0,we=0,me=0,h;He(()=>{if(h=document.querySelector(".timeline-container"),h){const t=Math.max(0,O(500)-h.clientWidth/2);h.scrollLeft=t}});function Ie(o){o.target.closest(".person-bar, .book-dot, .person-name, .book-title, .image-popup")||(V=!0,be=o.pageX-h.offsetLeft,_e=o.pageY-h.offsetTop,we=h.scrollLeft,me=h.scrollTop,h.style.cursor="grabbing")}function Re(o){if(!V)return;o.preventDefault();const t=o.pageX-h.offsetLeft,a=o.pageY-h.offsetTop,s=(t-be)*1.5,i=(a-_e)*1.5;h.scrollLeft=we-s,h.scrollTop=me-i}function Xe(){V=!1,h&&(h.style.cursor="grab")}function Se(){V&&(V=!1,h&&(h.style.cursor="grab"))}function ye(o,t){x(c,o);const a=Me(t.clientX,t.clientY);x(ne,a.x),x(ie,a.y),t.stopPropagation()}function ke(o,t){if(t.key==="Enter"||t.key===" "){t.preventDefault(),x(c,o);const a=t.target.getBoundingClientRect(),s=Me(a.left+a.width/2,a.top+a.height/2);x(ne,s.x),x(ie,s.y)}}function Me(o,t){const a={width:220,height:300},s=20;let i=o,n=t;return i+a.width/2>window.innerWidth-s&&(i=window.innerWidth-a.width/2-s),i-a.width/2<s&&(i=a.width/2+s),n+a.height/2>window.innerHeight-s&&(n=window.innerHeight-a.height/2-s),n-a.height/2<s&&(n=a.height/2+s),{x:i,y:n}}H(()=>ce(U()),()=>{x(D,Math.floor(Math.min(...U().map(o=>o.born||o.published||0))/100)*100-100)}),H(()=>ce(U()),()=>{x(B,Math.ceil(Math.max(...U().map(o=>o.died||new Date().getFullYear()||0))/100)*100)}),H(()=>(e(B),e(D)),()=>{x(F,(e(B)-e(D))*xe+K*2)}),H(()=>{},()=>{x(Y,y+K*3+re*2*(T+se))}),H(()=>ce(U()),()=>{x(m,[...U()].sort((o,t)=>(o.born||o.published||0)-(t.born||t.published||0)))}),H(()=>(e(B),e(D)),()=>{x(fe,Array.from({length:Math.ceil((e(B)-e(D))/100)+1},(o,t)=>Math.floor(e(D)/100)*100+t*100))}),H(()=>e(m),()=>{const o=[],t=[];for(let s=0;s<e(m).length;s++)s%2===0?(o.push(e(m)[s]),Pe(m,e(m)[s].placement="top")):(t.push(e(m)[s]),Pe(m,e(m)[s].placement="bottom"));function a(s){s.sort((i,n)=>(i.born||i.published||0)-(n.born||n.published||0));for(let i=0;i<s.length;i++){const n=s[i],I=n.born||n.published||0,W=n.died||new Date().getFullYear();let P=!1,f=1;for(;!P&&f<=re;)s.some((u,p)=>{if(p>=i||u.row!==f)return!1;const b=u.born||u.published||0,v=u.died||new Date().getFullYear();return ae(n)&&ae(u)?Math.abs(I-b)<30:I<=v+70&&W>=b-70})?f++:(n.row=f,P=!0);P||(n.row=re)}}a(o),a(t)}),Ne(),We();var C=et(),Q=_(C),ee=_(Q),le=_(ee),Ye=g(le);Ae(Ye,1,()=>e(fe),Ee,(o,t)=>{var a=Ve(),s=de(a);r(s,"y1",0);var i=g(s);r(i,"y",y-20);var n=_(i,!0);w(i),N((I,W,P,f)=>{r(s,"x1",I),r(s,"x2",W),r(s,"y2",e(Y)),r(i,"x",P),q(n,f)},[()=>O(e(t)),()=>O(e(t)),()=>O(e(t)),()=>L(e(t))],d),S(o,a)});var Z=g(Ye);r(Z,"x1",K),r(Z,"y1",y),r(Z,"y2",y);var $e=g(Z);Ae($e,1,()=>e(m),Ee,(o,t)=>{var a=Le();const s=d(()=>e(t).born||e(t).published||0),i=d(()=>ae(e(t))),n=d(()=>e(i)?e(t).title:e(t).name);var I=de(a);{var W=f=>{var l=Ze();const u=d(()=>O(e(s))),p=d(()=>e(t).placement==="top"),b=d(()=>(e(t).row-1)*(T+se)),v=d(()=>e(p)?y-J-e(b)-T/2:y+J+e(b)+T/2);var k=_(l),te=_(k,!0);w(k);var R=g(k);r(R,"r",ge);var M=g(R);w(l),N(G=>{r(l,"aria-label",`${e(n)??""} by ${e(t).author??""}, published ${G??""}`),r(k,"x",e(u)),r(k,"y",e(v)+(e(p)?-16:ve+6)),q(te,e(n)),r(R,"cx",e(u)),r(R,"cy",e(v)),r(M,"x1",e(u)),r(M,"y1",e(v)+(e(p)?ge:-6)),r(M,"x2",e(u)),r(M,"y2",y+(e(p)?-3:3))},[()=>L(e(s))],d),E("click",l,G=>ye(e(t),G)),E("keydown",l,G=>ke(e(t),G)),S(f,l)},P=f=>{var l=je();const u=d(()=>e(t).died||new Date().getFullYear()),p=d(()=>O(e(s))),b=d(()=>O(e(u))),v=d(()=>Math.max(e(b)-e(p),5)),k=d(()=>e(t).placement==="top"),te=d(()=>(e(t).row-1)*(T+se)),R=d(()=>e(k)?y-J-e(te)-T:y+J+e(te));var M=_(l),G=_(M,!0);w(M);var j=g(M);r(j,"height",T);var oe=g(j);w(l),N((X,Oe)=>{r(l,"aria-label",`${e(n)??""}, ${X??""} to ${Oe??""}`),r(M,"x",e(p)+e(v)/2),r(M,"y",e(R)+(e(k)?-10:T+ve)),q(G,e(n)),r(j,"x",e(p)),r(j,"y",e(R)),r(j,"width",e(v)),r(oe,"x1",e(p)+e(v)/2),r(oe,"y1",e(R)+(e(k)?T:0)),r(oe,"x2",e(p)+e(v)/2),r(oe,"y2",y+(e(k)?-3:3))},[()=>{var X;return(X=e(c))!=null&&X.born?L(e(t).born):""},()=>e(t).died?L(e(t).died):"present"],d),E("click",l,X=>ye(e(t),X)),E("keydown",l,X=>ke(e(t),X)),S(f,l)};ue(I,f=>{e(i)?f(W):f(P,!1)})}S(o,a)}),w(ee),w(Q);var Be=g(Q,2);{var Fe=o=>{var t=Qe(),a=_(t),s=g(a,2),i=_(s,!0);w(s);var n=g(s,2),I=_(n);{var W=l=>{var u=Je(),p=de(u,!0),b=g(p,2);N(v=>{q(p,e(c).author),q(b,` ${v??""}`)},[()=>L(e(c).published)],d),S(l,u)},P=l=>{var u=Ce();N((p,b,v)=>q(u,`${p??""} - 
          ${b??""}
          (${v??""} years)`),[()=>e(c).born?L(e(c).born):"",()=>e(c).died?L(e(c).died):"present",()=>e(c).died?Math.abs(e(c).died-e(c).born):Math.abs(new Date().getFullYear()-e(c).born)],d),S(l,u)};ue(I,l=>{e(c).title?l(W):l(P,!1)})}w(n);var f=g(n,2);w(t),N(l=>{De(t,`left: ${e(ne)??""}px; top: ${e(ie)??""}px;`),r(a,"src",l),r(a,"alt",e(c).name||e(c).title),q(i,e(c).name||e(c).title)},[()=>Ue(e(c).image)],d),E("click",f,()=>x(c,null)),S(o,t)};ue(Be,o=>{e(c)&&o(Fe)})}w(C),N(()=>{De(Q,`width: ${e(F)??""}px; height: ${e(Y)??""}px;`),r(ee,"width",e(F)),r(ee,"height",e(Y)),r(le,"width",e(F)),r(le,"height",e(Y)),r(Z,"x2",e(F)-K)}),E("mousedown",C,Ie),E("mousemove",C,Re),E("mouseup",C,Xe),E("mouseleave",C,Se),S($,C),qe()}export{lt as T};
