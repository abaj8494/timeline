import{t as dt,a as I,n as ft,c as Bt,b as Ot}from"./BIYvNW0b.js";import{i as Lt}from"./14nf3aC0.js";import{h as Yt,p as Wt,o as Gt,a0 as W,a1 as Ht,X as G,a as Nt,G as g,I as A,T as ct,x as t,a2 as Pt,Y as w,_,Z as x,W as pt,u as h}from"./CSOfU5Pt.js";import{e as H,s as N}from"./vckkWNzg.js";import{i as ht}from"./DBxt3fiE.js";import{t as $t,e as Tt,s as r,i as At,r as Ct}from"./D2bpMces.js";import{p as qt}from"./BWVsNKEK.js";function jt(R,$,j,S){var F=R.__style;if(Yt||F!==$){var Y=$t($);(!Yt||Y!==R.getAttribute("style"))&&(Y==null?R.removeAttribute("style"):R.style.cssText=Y),R.__style=$}return S}var Ut=ft('<line class="time-marker-line svelte-phiw1j"></line><text text-anchor="middle" class="time-marker svelte-phiw1j"> </text>',1),zt=ft('<g><text text-anchor="middle" class="book-title svelte-phiw1j"> </text><circle class="book-dot svelte-phiw1j"></circle><line stroke="#555" stroke-width="0.5" stroke-dasharray="2 2"></line></g>'),Vt=ft('<g><text text-anchor="middle" class="person-name svelte-phiw1j"> </text><rect class="person-bar svelte-phiw1j"></rect><line stroke="#555" stroke-width="0.5" stroke-dasharray="2 2"></line></g>'),Zt=dt(" <br> ",1),Jt=dt('<div class="image-popup svelte-phiw1j"><img class="svelte-phiw1j"> <h4 class="svelte-phiw1j"> </h4> <p class="svelte-phiw1j"><!></p> <button style="position: absolute; top: 5px; right: 5px; background: none; border: none; color: white; cursor: pointer; font-size: 16px;">Ã—</button></div>'),Kt=dt('<div class="timeline-container svelte-phiw1j"><div class="timeline-content svelte-phiw1j"><svg class="svelte-phiw1j"><rect x="0" y="0" fill="#17191C"></rect><!><line class="main-timeline svelte-phiw1j"></line><!></svg></div> <!></div>');function ne(R,$){Wt($,!1);const j=A(),S=A(),F=A(),Y=A(),b=A(),ut=A();let C=qt($,"items",8);const q=60,y=800,P=8,st=40,Z=90,vt=10,gt=1.2,ot=25,_t=6;function rt(e){return e.title!==void 0&&e.published!==void 0}function B(e){return(e-t(j))*gt+q}function J(e){return e===0?"0":e<0?`${Math.abs(e)}BC`:`${e}`}let l=A(null),at=A(0),nt=A(0),U=!1,mt=0,wt=0,xt=0,bt=0,d;Gt(()=>{if(d=document.querySelector(".timeline-container"),d){const s=Math.max(0,B(500)-d.clientWidth/2);d.scrollLeft=s}});function Et(e){e.target.closest(".person-bar, .book-dot, .person-name, .book-title, .image-popup")||(U=!0,mt=e.pageX-d.offsetLeft,wt=e.pageY-d.offsetTop,xt=d.scrollLeft,bt=d.scrollTop,d.style.cursor="grabbing")}function Dt(e){if(!U)return;e.preventDefault();const s=e.pageX-d.offsetLeft,i=e.pageY-d.offsetTop,o=(s-mt)*1.5,a=(i-wt)*1.5;d.scrollLeft=xt-o,d.scrollTop=bt-a}function Xt(){U=!1,d&&(d.style.cursor="grab")}function It(){U&&(U=!1,d&&(d.style.cursor="grab"))}function yt(e,s){const i={width:220,height:300},o=20;let a=e,n=s;return a+i.width/2>window.innerWidth-o&&(a=window.innerWidth-i.width/2-o),a-i.width/2<o&&(a=i.width/2+o),n+i.height/2>window.innerHeight-o&&(n=window.innerHeight-i.height/2-o),n-i.height/2<o&&(n=i.height/2+o),{x:a,y:n}}W(()=>ct(C()),()=>{g(j,Math.floor(Math.min(...C().map(e=>e.born||e.published||0))/100)*100-100)}),W(()=>ct(C()),()=>{g(S,Math.ceil(Math.max(...C().map(e=>e.died||new Date().getFullYear()||0))/100)*100)}),W(()=>(t(S),t(j)),()=>{g(F,(t(S)-t(j))*gt+q*2)}),W(()=>{},()=>{g(Y,y+q*3+ot*2*(P+st))}),W(()=>ct(C()),()=>{g(b,[...C()].sort((e,s)=>(e.born||e.published||0)-(s.born||s.published||0)))}),W(()=>(t(S),t(j)),()=>{g(ut,Array.from({length:Math.ceil((t(S)-t(j))/100)+1},(e,s)=>Math.floor(t(j)/100)*100+s*100))}),W(()=>t(b),()=>{const e=[],s=[];for(let o=0;o<t(b).length;o++)o%2===0?(e.push(t(b)[o]),Pt(b,t(b)[o].placement="top")):(s.push(t(b)[o]),Pt(b,t(b)[o].placement="bottom"));function i(o){o.sort((a,n)=>(a.born||a.published||0)-(n.born||n.published||0));for(let a=0;a<o.length;a++){const n=o[a],E=n.born||n.published||0,L=n.died||new Date().getFullYear();let T=!1,u=1;for(;!T&&u<=ot;)o.some((p,f)=>{if(f>=a||p.row!==u)return!1;const m=p.born||p.published||0,v=p.died||new Date().getFullYear();return rt(n)&&rt(p)?Math.abs(E-m)<30:E<=v+70&&L>=m-70})?u++:(n.row=u,T=!0);T||(n.row=ot)}}i(e),i(s)}),Ht(),Lt();var O=Kt(),K=w(O),Q=w(K),it=w(Q),kt=_(it);Tt(kt,1,()=>t(ut),At,(e,s)=>{var i=Ut(),o=pt(i);r(o,"y1",0);var a=_(o);r(a,"y",y-20);var n=w(a,!0);x(a),G((E,L,T,u)=>{r(o,"x1",E),r(o,"x2",L),r(o,"y2",t(Y)),r(a,"x",T),N(n,u)},[()=>B(t(s)),()=>B(t(s)),()=>B(t(s)),()=>J(t(s))],h),I(e,i)});var z=_(kt);r(z,"x1",q),r(z,"y1",y),r(z,"y2",y);var Rt=_(z);Tt(Rt,1,()=>t(b),At,(e,s)=>{var i=Bt();const o=h(()=>t(s).born||t(s).published||0),a=h(()=>rt(t(s))),n=h(()=>t(a)?t(s).title:t(s).name);var E=pt(i);{var L=u=>{var c=zt();const p=h(()=>B(t(o))),f=h(()=>t(s).placement==="top"),m=h(()=>(t(s).row-1)*(P+st)),v=h(()=>t(f)?y-Z-t(m)-P/2:y+Z+t(m)+P/2);var k=w(c),tt=w(k,!0);x(k);var D=_(k);r(D,"r",_t);var M=_(D);x(c),G(()=>{r(k,"x",t(p)),r(k,"y",t(v)+(t(f)?-16:vt+6)),N(tt,t(n)),r(D,"cx",t(p)),r(D,"cy",t(v)),r(M,"x1",t(p)),r(M,"y1",t(v)+(t(f)?_t:-6)),r(M,"x2",t(p)),r(M,"y2",y+(t(f)?-3:3))}),H("click",c,V=>{g(l,t(s));const X=yt(V.clientX,V.clientY);g(at,X.x),g(nt,X.y),V.stopPropagation()}),I(u,c)},T=u=>{var c=Vt();const p=h(()=>t(s).died||new Date().getFullYear()),f=h(()=>B(t(o))),m=h(()=>B(t(p))),v=h(()=>Math.max(t(m)-t(f),5)),k=h(()=>t(s).placement==="top"),tt=h(()=>(t(s).row-1)*(P+st)),D=h(()=>t(k)?y-Z-t(tt)-P:y+Z+t(tt));var M=w(c),V=w(M,!0);x(M);var X=_(M);r(X,"height",P);var et=_(X);x(c),G(()=>{r(M,"x",t(f)+t(v)/2),r(M,"y",t(D)+(t(k)?-10:P+vt)),N(V,t(n)),r(X,"x",t(f)),r(X,"y",t(D)),r(X,"width",t(v)),r(et,"x1",t(f)+t(v)/2),r(et,"y1",t(D)+(t(k)?P:0)),r(et,"x2",t(f)+t(v)/2),r(et,"y2",y+(t(k)?-3:3))}),H("click",c,lt=>{g(l,t(s));const Mt=yt(lt.clientX,lt.clientY);g(at,Mt.x),g(nt,Mt.y),lt.stopPropagation()}),I(u,c)};ht(E,u=>{t(a)?u(L):u(T,!1)})}I(e,i)}),x(Q),x(K);var St=_(K,2);{var Ft=e=>{var s=Jt(),i=w(s),o=_(i,2),a=w(o,!0);x(o);var n=_(o,2),E=w(n);{var L=c=>{var p=Zt(),f=pt(p,!0),m=_(f,2);G(v=>{N(f,t(l).author),N(m,` ${v??""}`)},[()=>J(t(l).published)],h),I(c,p)},T=c=>{var p=Ot();G((f,m,v)=>N(p,`${f??""} - 
          ${m??""}
          (${v??""} years)`),[()=>t(l).born?J(t(l).born):"",()=>t(l).died?J(t(l).died):"present",()=>t(l).died?Math.abs(t(l).died-t(l).born):Math.abs(new Date().getFullYear()-t(l).born)],h),I(c,p)};ht(E,c=>{t(l).title?c(L):c(T,!1)})}x(n);var u=_(n,2);x(s),G(c=>{jt(s,`left: ${t(at)??""}px; top: ${t(nt)??""}px;`),r(i,"src",c),r(i,"alt",t(l).name||t(l).title),N(a,t(l).name||t(l).title)},[()=>Ct(t(l).image)],h),H("click",u,()=>g(l,null)),I(e,s)};ht(St,e=>{t(l)&&e(Ft)})}x(O),G(()=>{jt(K,`width: ${t(F)??""}px; height: ${t(Y)??""}px;`),r(Q,"width",t(F)),r(Q,"height",t(Y)),r(it,"width",t(F)),r(it,"height",t(Y)),r(z,"x2",t(F)-q)}),H("mousedown",O,Et),H("mousemove",O,Dt),H("mouseup",O,Xt),H("mouseleave",O,It),I(R,O),Nt()}export{ne as T};
