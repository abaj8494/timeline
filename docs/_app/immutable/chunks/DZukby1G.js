import{t as dt,a as O,n as gt,c as Zt,b as Jt}from"./tV2K8-t_.js";import{i as Qt}from"./ByiRlZ4K.js";import{o as te}from"./uz48rOOJ.js";import{v as It,p as ee,a3 as Z,a4 as oe,_ as z,a as ne,k as v,m as I,X as xt,c as t,a5 as Bt,$ as A,a1 as m,a0 as E,Z as lt,d as u}from"./WXaAkZrh.js";import{e as y,s as C}from"./F6O-0aNN.js";import{i as it}from"./Bj7JGMQR.js";import{a as re,e as Rt,s,i as $t,r as se}from"./CLQ0dl1W.js";import{p as ae}from"./B3nBOueu.js";function ct(N,J,L,H){var G=N.__style;if(It||G!==J){var B=re(J);(!It||B!==N.getAttribute("style"))&&(B==null?N.removeAttribute("style"):N.style.cssText=B),N.__style=J}return H}var le=gt('<line class="time-marker-line svelte-42xpdj"></line><text text-anchor="middle" class="time-marker svelte-42xpdj"> </text>',1),ie=gt('<g role="button" tabindex="0" class="svelte-42xpdj"><text text-anchor="middle" class="book-title svelte-42xpdj"> </text><circle class="book-dot svelte-42xpdj"></circle><line stroke="#555" stroke-width="0.5" stroke-dasharray="2 2"></line></g>'),ce=gt('<g role="button" tabindex="0" class="svelte-42xpdj"><text text-anchor="middle" class="person-name svelte-42xpdj"> </text><rect class="person-bar svelte-42xpdj"></rect><line stroke="#555" stroke-width="0.5" stroke-dasharray="2 2"></line></g>'),de=dt(" <br> ",1),ue=dt(" <br> ",1),he=dt('<div class="image-popup svelte-42xpdj"><img class="svelte-42xpdj"> <h4 class="svelte-42xpdj"> </h4> <p class="svelte-42xpdj"><!></p> <button style="position: absolute; top: 5px; right: 5px; background: none; border: none; color: white; cursor: pointer; font-size: 16px;">Ã—</button></div>'),fe=dt('<div class="timeline-container svelte-42xpdj" role="application" aria-label="Interactive timeline visualization - click and drag to pan, scroll to zoom, pinch to zoom on mobile"><div class="timeline-content svelte-42xpdj"><svg class="svelte-42xpdj"><rect x="0" y="0" fill="#17191C"></rect><!><line class="main-timeline svelte-42xpdj"></line><!></svg></div> <!></div>');function we(N,J){ee(J,!1);const L=I(),H=I(),G=I(),B=I(),F=I(),bt=I();let Q=ae(J,"items",8);const tt=60,P=800,R=8,ut=40,nt=90,_t=10,ht=1.2,ft=25,yt=6;function wt(e){return e.title!==void 0&&e.published!==void 0}function kt(e){return e.title!==void 0&&e.created!==void 0}function Mt(e){return wt(e)||kt(e)}function V(e){return(e-t(L))*ht+tt}function U(e){return e===0?"0":e<0?`${Math.abs(e)}BC`:`${e}`}let c=I(null),pt=I(0),vt=I(0),et=!1,Yt=0,Dt=0,Tt=0,St=0,i,rt=0,At=1,D=I(1);te(()=>{if(i=document.querySelector(".timeline-container"),i){const o=Math.max(0,V(500)-i.clientWidth/2);i.scrollLeft=o}});function Ot(e){e.target.closest(".person-bar, .book-dot, .person-name, .book-title, .image-popup")||(t(c)&&v(c,null),et=!0,Yt=e.pageX-i.offsetLeft,Dt=e.pageY-i.offsetTop,Tt=i.scrollLeft,St=i.scrollTop,i.style.cursor="grabbing")}function Ct(e){if(!et)return;e.preventDefault();const o=e.pageX-i.offsetLeft,r=e.pageY-i.offsetTop,n=(o-Yt)*1.5,a=(r-Dt)*1.5;i.scrollLeft=Tt-n,i.scrollTop=St-a}function Lt(){et=!1,i&&(i.style.cursor="grab")}function Wt(){et&&(et=!1,i&&(i.style.cursor="grab"))}function qt(e){e.preventDefault();const n=1+-e.deltaY*.001,a=Math.max(1,Math.min(3,t(D)*n));if(a===t(D))return;const l=i.getBoundingClientRect(),w=e.clientX-l.left,k=e.clientY-l.top,S=i.scrollLeft,M=i.scrollTop,x=(S+w)/t(D),h=(M+k)/t(D);v(D,a);const d=i==null?void 0:i.querySelector(".timeline-content");d&&(d.style.transform=`scale(${t(D)})`,d.style.transformOrigin="top left"),i.scrollLeft=x*a-w,i.scrollTop=h*a-k}function Et(e){const o=e[0].clientX-e[1].clientX,r=e[0].clientY-e[1].clientY;return Math.sqrt(o*o+r*r)}function zt(e){e.touches.length===2&&(e.preventDefault(),rt=Et(e.touches),At=t(D))}function Nt(e){if(e.touches.length===2&&rt>0){e.preventDefault();const r=Et(e.touches)/rt,n=Math.max(1,Math.min(3,At*r));v(D,n);const a=i==null?void 0:i.querySelector(".timeline-content");a&&(a.style.transform=`scale(${t(D)})`,a.style.transformOrigin="top left")}}function Ht(e){e.touches.length<2&&(rt=0)}function Ft(e,o){v(c,e);const r=Xt(o.clientX,o.clientY);v(pt,r.x),v(vt,r.y),o.stopPropagation()}function Pt(e,o){if(o.key==="Enter"||o.key===" "){o.preventDefault(),v(c,e);const r=o.target.getBoundingClientRect(),n=Xt(r.left+r.width/2,r.top+r.height/2);v(pt,n.x),v(vt,n.y)}}function Xt(e,o){const r={width:220,height:300},n=20;let a=e,l=o;return a+r.width/2>window.innerWidth-n&&(a=window.innerWidth-r.width/2-n),a-r.width/2<n&&(a=r.width/2+n),l+r.height/2>window.innerHeight-n&&(l=window.innerHeight-r.height/2-n),l-r.height/2<n&&(l=r.height/2+n),{x:a,y:l}}Z(()=>xt(Q()),()=>{v(L,Math.floor(Math.min(...Q().map(e=>e.born||e.published||e.created||0))/100)*100-100)}),Z(()=>xt(Q()),()=>{v(H,Math.ceil(Math.max(...Q().map(e=>e.died||e.created||e.published||new Date().getFullYear()||0))/100)*100)}),Z(()=>(t(H),t(L)),()=>{v(G,(t(H)-t(L))*ht+tt*2)}),Z(()=>{},()=>{v(B,P+tt*3+ft*2*(R+ut))}),Z(()=>xt(Q()),()=>{v(F,[...Q()].sort((e,o)=>(e.born||e.published||e.created||0)-(o.born||o.published||o.created||0)))}),Z(()=>(t(H),t(L)),()=>{v(bt,Array.from({length:Math.ceil((t(H)-t(L))/100)+1},(e,o)=>Math.floor(t(L)/100)*100+o*100))}),Z(()=>t(F),()=>{const e=[],o=[];for(let n=0;n<t(F).length;n++)n%2===0?(e.push(t(F)[n]),Bt(F,t(F)[n].placement="top")):(o.push(t(F)[n]),Bt(F,t(F)[n].placement="bottom"));function r(n){n.sort((a,l)=>(a.born||a.published||a.created||0)-(l.born||l.published||l.created||0));for(let a=0;a<n.length;a++){const l=n[a],w=l.born||l.published||l.created||0,k=l.died||l.created||l.published||new Date().getFullYear();let S=!1,M=1;for(;!S&&M<=ft;)n.some((h,d)=>{var b,p;if(d>=a||h.row!==M)return!1;const g=h.born||h.published||h.created||0,f=h.died||h.created||h.published||new Date().getFullYear();if(Mt(l)&&Mt(h)){const _=(((b=l.title)==null?void 0:b.length)||0)*6,X=(((p=h.title)==null?void 0:p.length)||0)*6,Y=Math.max(_,X),$=Math.max(50,Y/ht);return Math.abs(w-g)<$}return w<=f+70&&k>=g-70})?M++:(l.row=M,S=!0);S||(l.row=ft)}}r(e),r(o)}),oe(),Qt();var T=fe(),st=A(T),at=A(st),mt=A(at),jt=m(mt);Rt(jt,1,()=>t(bt),$t,(e,o)=>{var r=le(),n=lt(r);s(n,"y1",0);var a=m(n);s(a,"y",P-20);var l=A(a,!0);E(a),z((w,k,S,M)=>{s(n,"x1",w),s(n,"x2",k),s(n,"y2",t(B)),s(a,"x",S),C(l,M)},[()=>V(t(o)),()=>V(t(o)),()=>V(t(o)),()=>U(t(o))],u),O(e,r)});var ot=m(jt);s(ot,"x1",tt),s(ot,"y1",P),s(ot,"y2",P);var Gt=m(ot);Rt(Gt,1,()=>t(F),$t,(e,o)=>{var r=Zt();const n=u(()=>t(o).born||t(o).published||t(o).created||0),a=u(()=>wt(t(o))),l=u(()=>kt(t(o))),w=u(()=>t(a)||t(l)),k=u(()=>t(w)?t(o).title:t(o).name);var S=lt(r);{var M=h=>{var d=ie();const g=u(()=>V(t(n))),f=u(()=>t(o).placement==="top"),b=u(()=>(t(o).row-1)*(R+ut)),p=u(()=>t(f)?P-nt-t(b)-R/2:P+nt+t(b)+R/2),_=u(()=>t(l)?"#FF6B9D":"#4A9EFF"),X=u(()=>t(l)?"{displayName} by {item.artist}, created {formatYear(yearValue)}":"{displayName} by {item.author}, published {formatYear(yearValue)}");var Y=A(d),$=A(Y,!0);E(Y);var K=m(Y);s(K,"r",yt);var j=m(K);E(d),z(()=>{s(d,"aria-label",t(X)),s(Y,"x",t(g)),s(Y,"y",t(p)+(t(f)?-16:_t+6)),ct(Y,`fill: ${t(l)?"#FF6B9D":"#4A9EFF"}`),C($,t(k)),s(K,"cx",t(g)),s(K,"cy",t(p)),ct(K,`fill: ${t(_)??""}; stroke: ${t(_)??""}`),s(j,"x1",t(g)),s(j,"y1",t(p)+(t(f)?yt:-6)),s(j,"x2",t(g)),s(j,"y2",P+(t(f)?-3:3))}),y("click",d,W=>Ft(t(o),W)),y("keydown",d,W=>Pt(t(o),W)),O(h,d)},x=h=>{var d=ce();const g=u(()=>t(o).died||new Date().getFullYear()),f=u(()=>V(t(n))),b=u(()=>V(t(g))),p=u(()=>Math.max(t(b)-t(f),5)),_=u(()=>t(o).placement==="top"),X=u(()=>(t(o).row-1)*(R+ut)),Y=u(()=>t(_)?P-nt-t(X)-R:P+nt+t(X));var $=A(d),K=A($,!0);E($);var j=m($);s(j,"height",R);var W=m(j);E(d),z((q,Kt)=>{s(d,"aria-label",`${t(k)??""}, ${q??""} to ${Kt??""}`),s($,"x",t(f)+t(p)/2),s($,"y",t(Y)+(t(_)?-10:R+_t)),C(K,t(k)),s(j,"x",t(f)),s(j,"y",t(Y)),s(j,"width",t(p)),s(W,"x1",t(f)+t(p)/2),s(W,"y1",t(Y)+(t(_)?R:0)),s(W,"x2",t(f)+t(p)/2),s(W,"y2",P+(t(_)?-3:3))},[()=>{var q;return(q=t(c))!=null&&q.born?U(t(o).born):""},()=>t(o).died?U(t(o).died):"present"],u),y("click",d,q=>Ft(t(o),q)),y("keydown",d,q=>Pt(t(o),q)),O(h,d)};it(S,h=>{t(w)?h(M):h(x,!1)})}O(e,r)}),E(at),E(st);var Vt=m(st,2);{var Ut=e=>{var o=he(),r=A(o),n=m(r,2),a=A(n,!0);E(n);var l=m(n,2),w=A(l);{var k=x=>{var h=de(),d=lt(h,!0),g=m(d,2);z(f=>{C(d,t(c).artist),C(g,` ${f??""}`)},[()=>U(t(c).created)],u),O(x,h)},S=(x,h)=>{{var d=f=>{var b=ue(),p=lt(b,!0),_=m(p,2);z(X=>{C(p,t(c).author),C(_,` ${X??""}`)},[()=>U(t(c).published)],u),O(f,b)},g=f=>{var b=Jt();z((p,_,X)=>C(b,`${p??""} - 
          ${_??""}
          (${X??""} years)`),[()=>t(c).born?U(t(c).born):"",()=>t(c).died?U(t(c).died):"present",()=>t(c).died?Math.abs(t(c).died-t(c).born):Math.abs(new Date().getFullYear()-t(c).born)],u),O(f,b)};it(x,f=>{t(c).published?f(d):f(g,!1)},h)}};it(w,x=>{t(c).created?x(k):x(S,!1)})}E(l);var M=m(l,2);E(o),z(x=>{ct(o,`left: ${t(pt)??""}px; top: ${t(vt)??""}px;`),s(r,"src",x),s(r,"alt",t(c).name||t(c).title),C(a,t(c).name||t(c).title)},[()=>se(t(c).image)],u),y("click",M,()=>v(c,null)),O(e,o)};it(Vt,e=>{t(c)&&e(Ut)})}E(T),z(()=>{ct(st,`width: ${t(G)*t(D)}px; height: ${t(B)*t(D)}px;`),s(at,"width",t(G)),s(at,"height",t(B)),s(mt,"width",t(G)),s(mt,"height",t(B)),s(ot,"x2",t(G)-tt)}),y("mousedown",T,Ot),y("mousemove",T,Ct),y("mouseup",T,Lt),y("mouseleave",T,Wt),y("wheel",T,qt),y("touchstart",T,zt),y("touchmove",T,Nt),y("touchend",T,Ht),O(N,T),ne()}export{we as T};
