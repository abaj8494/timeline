import{t as q,a as C,c as Kt,n as Et}from"./CXO4SUQH.js";import{i as Qt}from"./CCMQ1FqB.js";import{o as Ut}from"./UKlZL6Oz.js";import{p as Vt,O as W,Q as Zt,R,a as jt,T as w,V as S,m as f,n as y,e as t,W as j,X as bt,Y as b,Z as lt,d as k}from"./CbWlX3Uk.js";import{e as D,s as $}from"./D2Q5qIZK.js";import{i as z}from"./C8t1nucw.js";import{e as it,s as i,i as ct}from"./CN872F4n.js";import{s as ft}from"./-uhDPwO0.js";import{p as Tt}from"./sWsCrfk1.js";var Jt=Et('<line class="time-marker-line svelte-366wf1"></line><text text-anchor="middle" class="time-marker svelte-366wf1"> </text>',1),te=Et('<g role="button" tabindex="0" class="svelte-366wf1"><text text-anchor="middle" class="event-label svelte-366wf1"> </text><rect rx="3" ry="3" class="event-bar svelte-366wf1"></rect><line stroke="#555" stroke-width="0.5" stroke-dasharray="2 2"></line></g>'),ee=q('<p class="subtitle svelte-366wf1"> </p>'),ne=q("<br> ",1),se=q('<span class="tag svelte-366wf1"> </span>'),oe=q('<div class="tags svelte-366wf1"></div>'),ae=q('<div class="event-popup svelte-366wf1"><button class="close-btn svelte-366wf1">Ã—</button> <h4 class="svelte-366wf1"> </h4> <!> <div class="time-label svelte-366wf1"> <!></div> <!></div>'),re=q('<div class="event-timeline-container svelte-366wf1" role="application" aria-label="Interactive event timeline - click and drag to pan, scroll to zoom"><div class="timeline-content svelte-366wf1"><svg class="svelte-366wf1"><rect x="0" y="0" fill="#17191C"></rect><!><line class="main-timeline svelte-366wf1"></line><!></svg></div> <!></div>');function me(St,J){Vt(J,!1);const x=y(),A=y(),K=y(),tt=y(),Y=y(),F=y(),X=y(),ut=y();let H=Tt(J,"items",8),Q=Tt(J,"scaleType",8,"linear");const B=60,O=500,L=12,ht=35,dt=60,Dt=8,et=20,Xt=3e3,kt=2500;let nt=y(0);function P(e){const n=t(Y)-B*2;if(Q()==="log"){const s=Math.log10(t(x)+t(K)+1),o=Math.log10(t(A)+t(K)+1),l=(Math.log10(e+t(K)+1)-s)/(o-s);return B+l*n}else{const s=(e-t(x))/(t(A)-t(x));return B+s*n}}function At(){const e=[],n=t(A)-t(x);if(Q()==="log"){const s=[-9,-8,-7,-6,-5,-4,-3,-2,-1,0];for(const a of s){const l=Math.pow(10,Math.abs(a))*(a<0?-1:1);l>=t(x)&&l<=t(A)&&e.push(l)}const o=[-138e8,-45e8,-1e9,-1e8,-1e7,-1e6,-1e5,-1e4,-1e3,0,1e3,2e3];for(const a of o)a>=t(x)&&a<=t(A)&&!e.includes(a)&&e.push(a)}else{let s;n>1e4?s=2e3:n>5e3?s=1e3:n>1e3?s=500:n>500?s=100:s=50;const o=Math.ceil(t(x)/s)*s;for(let a=o;a<=t(A);a+=s)e.push(a)}return e.sort((s,o)=>s-o)}function vt(e){const n=Math.abs(e);return n>=1e9?`${(e/1e9).toFixed(1)} Ga`:n>=1e6?`${(e/1e6).toFixed(1)} Ma`:n>=1e3?e<0?`${Math.abs(e)} BC`:`${e} AD`:e<0?`${Math.abs(e)} BC`:`${e} AD`}let h=y(null),st=y(0),ot=y(0),G=!1,pt=0,mt=0,gt=0,_t=0,r,U=0,xt=1,v=y(1);Ut(()=>{if(r=document.querySelector(".event-timeline-container"),r){f(nt,r.clientWidth);const e=r.querySelector(".timeline-content");if(e){const n=r.clientWidth/t(Y),s=r.clientHeight/t(F),o=Math.min(n,s)*.95;f(v,Math.max(.1,Math.min(50,o))),e.style.transform=`scale(${t(v)})`,e.style.transformOrigin="top left";const a=t(Y)*t(v),l=t(F)*t(v);r.scrollLeft=Math.max(0,(a-r.clientWidth)/2),r.scrollTop=Math.max(0,(l-r.clientHeight)/2)}}});function Yt(e){e.target.closest(".event-bar, .event-label, .event-popup")||(t(h)&&f(h,null),G=!0,pt=e.pageX-r.offsetLeft,mt=e.pageY-r.offsetTop,gt=r.scrollLeft,_t=r.scrollTop,r.style.cursor="grabbing")}function Bt(e){if(!G)return;e.preventDefault();const n=e.pageX-r.offsetLeft,s=e.pageY-r.offsetTop,o=(n-pt)*1.5,a=(s-mt)*1.5;r.scrollLeft=gt-o,r.scrollTop=_t-a}function Ct(){G=!1,r&&(r.style.cursor="grab")}function Wt(){G&&(G=!1,r&&(r.style.cursor="grab"))}function It(e){e.preventDefault();const o=1+-e.deltaY*.001,a=Math.max(.1,Math.min(50,t(v)*o));if(a===t(v))return;const l=r.getBoundingClientRect(),p=e.clientX-l.left,g=e.clientY-l.top,u=r.scrollLeft,m=r.scrollTop,M=(u+p)/t(v),E=(m+g)/t(v);f(v,a);const _=r==null?void 0:r.querySelector(".timeline-content");_&&(_.style.transform=`scale(${t(v)})`,_.style.transformOrigin="top left"),r.scrollLeft=M*a-p,r.scrollTop=E*a-g}function wt(e){const n=e[0].clientX-e[1].clientX,s=e[0].clientY-e[1].clientY;return Math.sqrt(n*n+s*s)}function Ft(e){e.touches.length===2&&(e.preventDefault(),U=wt(e.touches),xt=t(v))}function Ot(e){if(e.touches.length===2&&U>0){e.preventDefault();const s=wt(e.touches)/U;f(v,Math.max(.1,Math.min(50,xt*s)));const o=r==null?void 0:r.querySelector(".timeline-content");o&&(o.style.transform=`scale(${t(v)})`,o.style.transformOrigin="top left")}}function Pt(e){e.touches.length<2&&(U=0)}function Rt(e,n){f(h,e);const s=yt(n.clientX,n.clientY);f(st,s.x),f(ot,s.y),n.stopPropagation()}function $t(e,n){if(n.key==="Enter"||n.key===" "){n.preventDefault(),f(h,e);const s=n.target.getBoundingClientRect(),o=yt(s.left+s.width/2,s.top+s.height/2);f(st,o.x),f(ot,o.y)}}function yt(e,n){const s={width:300,height:200},o=20;let a=e,l=n;return a+s.width/2>window.innerWidth-o&&(a=window.innerWidth-s.width/2-o),a-s.width/2<o&&(a=s.width/2+o),l+s.height/2>window.innerHeight-o&&(l=window.innerHeight-s.height/2-o),l-s.height/2<o&&(l=s.height/2+o),{x:a,y:l}}function Ht(e){const n=e.tags||[];return n.includes("extinction")?"#EF4444":n.includes("war")?"#DC2626":n.includes("biology")?"#22C55E":n.includes("humanity")?"#F59E0B":n.includes("politics")?"#6366F1":n.includes("religion")||n.includes("philosophy")?"#8B5CF6":n.includes("science")||n.includes("technology")?"#3B82F6":n.includes("culture")||n.includes("art")?"#EC4899":n.includes("economy")?"#14B8A6":n.includes("cosmology")||n.includes("astronomy")||n.includes("physics")?"#06B6D4":n.includes("earth")||n.includes("chemistry")?"#84CC16":"#FA6742"}W(()=>j(H()),()=>{f(x,Math.min(...H().map(e=>e.start)))}),W(()=>j(H()),()=>{f(A,Math.max(...H().map(e=>e.end)))}),W(()=>t(x),()=>{f(K,t(x)<0?Math.abs(t(x))+1:0)}),W(()=>(j(Q()),t(A),t(x)),()=>{f(tt,Q()==="log"?kt:Math.max(Xt,(t(A)-t(x))*.15))}),W(()=>(t(tt),t(nt)),()=>{f(Y,Math.max(t(tt),t(nt)/.5)+B*2)}),W(()=>{},()=>{f(F,O+B*3+et*2*(L+ht))}),W(()=>j(H()),()=>{f(X,[...H()].sort((e,n)=>e.start-n.start))}),W(()=>{},()=>{f(ut,At())}),W(()=>t(X),()=>{const e=[],n=[];for(let o=0;o<t(X).length;o++)o%2===0?(e.push(t(X)[o]),bt(X,t(X)[o].placement="top")):(n.push(t(X)[o]),bt(X,t(X)[o].placement="bottom"));function s(o){o.sort((a,l)=>a.start-l.start);for(let a=0;a<o.length;a++){const l=o[a],p=P(l.start),g=P(l.end);let u=!1,m=1;for(;!u&&m<=et;)o.some((E,_)=>{if(_>=a||E.row!==m)return!1;const c=P(E.start),d=P(E.end),I=50;return p<=d+I&&g>=c-I})?m++:(l.row=m,u=!0);u||(l.row=et)}}s(e),s(n)}),Zt(),Qt();var T=re(),V=S(T),Z=S(V),at=S(Z),Mt=w(at);it(Mt,1,()=>t(ut),ct,(e,n)=>{var s=Kt();const o=k(()=>P(t(n)));var a=lt(s);{var l=p=>{var g=Jt(),u=lt(g);i(u,"y1",0);var m=w(u);i(m,"y",O-15);var M=S(m,!0);b(m),R(E=>{i(u,"x1",t(o)),i(u,"x2",t(o)),i(u,"y2",t(F)),i(m,"x",t(o)),$(M,E)},[()=>vt(t(n))],k),C(p,g)};z(a,p=>{t(o)>=B&&t(o)<=t(Y)-B&&p(l)})}C(e,s)});var N=w(Mt);i(N,"x1",B),i(N,"y1",O),i(N,"y2",O);var Lt=w(N);it(Lt,1,()=>t(X),ct,(e,n)=>{var s=te();const o=k(()=>P(t(n).start)),a=k(()=>P(t(n).end)),l=k(()=>Math.max(t(a)-t(o),8)),p=k(()=>t(n).placement==="top"),g=k(()=>(t(n).row-1)*(L+ht)),u=k(()=>t(p)?O-dt-t(g)-L:O+dt+t(g)),m=k(()=>Ht(t(n)));var M=S(s),E=S(M,!0);b(M);var _=w(M);i(_,"height",L);var c=w(_);b(s),R(()=>{i(s,"aria-label",t(n).title),i(M,"x",t(o)+t(l)/2),i(M,"y",t(u)+(t(p)?-8:L+Dt+4)),$(E,t(n).title),i(_,"x",t(o)),i(_,"y",t(u)),i(_,"width",t(l)),ft(_,`fill: ${t(m)??""}`),i(c,"x1",t(o)+t(l)/2),i(c,"y1",t(u)+(t(p)?L:0)),i(c,"x2",t(o)+t(l)/2),i(c,"y2",O+(t(p)?-3:3))}),D("click",s,d=>Rt(t(n),d)),D("keydown",s,d=>$t(t(n),d)),C(e,s)}),b(Z),b(V);var qt=w(V,2);{var Gt=e=>{var n=ae(),s=S(n),o=w(s,2),a=S(o,!0);b(o);var l=w(o,2);{var p=c=>{var d=ee(),I=S(d,!0);b(d),R(()=>$(I,t(h).subtitle)),C(c,d)};z(l,c=>{t(h).subtitle&&c(p)})}var g=w(l,2),u=S(g),m=w(u);{var M=c=>{var d=ne(),I=w(lt(d),1,!0);R(()=>$(I,t(h).region)),C(c,d)};z(m,c=>{t(h).region&&c(M)})}b(g);var E=w(g,2);{var _=c=>{var d=oe();it(d,5,()=>t(h).tags,ct,(I,Nt)=>{var rt=se(),zt=S(rt,!0);b(rt),R(()=>$(zt,t(Nt))),C(I,rt)}),b(d),C(c,d)};z(E,c=>{t(h).tags&&t(h).tags.length>0&&c(_)})}b(n),R(c=>{ft(n,`left: ${t(st)??""}px; top: ${t(ot)??""}px;`),$(a,t(h).title),$(u,`${c??""} `)},[()=>t(h).labelTime||vt(t(h).start)],k),D("click",s,()=>f(h,null)),C(e,n)};z(qt,e=>{t(h)&&e(Gt)})}b(T),R(()=>{ft(V,`width: ${t(Y)*t(v)}px; height: ${t(F)*t(v)}px;`),i(Z,"width",t(Y)),i(Z,"height",t(F)),i(at,"width",t(Y)),i(at,"height",t(F)),i(N,"x2",t(Y)-B)}),D("mousedown",T,Yt),D("mousemove",T,Bt),D("mouseup",T,Ct),D("mouseleave",T,Wt),D("wheel",T,It),D("touchstart",T,Ft),D("touchmove",T,Ot),D("touchend",T,Pt),C(St,T),jt()}export{me as E};
