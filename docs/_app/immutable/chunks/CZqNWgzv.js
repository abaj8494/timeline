import{t as vt,a as B,n as mt,c as Gt,b as Ut}from"./tV2K8-t_.js";import{i as Kt}from"./ByiRlZ4K.js";import{o as Vt}from"./uz48rOOJ.js";import{v as At,p as Zt,a3 as z,a4 as jt,_ as G,a as Jt,k as m,m as X,X as ut,c as t,a5 as Et,$ as y,a1 as g,a0 as k,Z as ft,d}from"./WXaAkZrh.js";import{e as x,s as U}from"./F6O-0aNN.js";import{i as pt}from"./Bj7JGMQR.js";import{a as Qt,e as Xt,s,i as It,r as te}from"./CDM55lSx.js";import{p as ee}from"./B3nBOueu.js";function $t(F,K,I,O){var W=F.__style;if(At||W!==K){var P=Qt(K);(!At||P!==F.getAttribute("style"))&&(P==null?F.removeAttribute("style"):F.style.cssText=P),F.__style=K}return O}var ne=mt('<line class="time-marker-line svelte-179nmnb"></line><text text-anchor="middle" class="time-marker svelte-179nmnb"> </text>',1),oe=mt('<g role="button" tabindex="0" class="svelte-179nmnb"><text text-anchor="middle" class="book-title svelte-179nmnb"> </text><circle class="book-dot svelte-179nmnb"></circle><line stroke="#555" stroke-width="0.5" stroke-dasharray="2 2"></line></g>'),se=mt('<g role="button" tabindex="0" class="svelte-179nmnb"><text text-anchor="middle" class="person-name svelte-179nmnb"> </text><rect class="person-bar svelte-179nmnb"></rect><line stroke="#555" stroke-width="0.5" stroke-dasharray="2 2"></line></g>'),ae=vt(" <br> ",1),re=vt('<div class="image-popup svelte-179nmnb"><img class="svelte-179nmnb"> <h4 class="svelte-179nmnb"> </h4> <p class="svelte-179nmnb"><!></p> <button style="position: absolute; top: 5px; right: 5px; background: none; border: none; color: white; cursor: pointer; font-size: 16px;">Ã—</button></div>'),ie=vt('<div class="timeline-container svelte-179nmnb" role="application" aria-label="Interactive timeline visualization - click and drag to pan, pinch to zoom on mobile"><div class="timeline-content svelte-179nmnb"><svg class="svelte-179nmnb"><rect x="0" y="0" fill="#17191C"></rect><!><line class="main-timeline svelte-179nmnb"></line><!></svg></div> <!></div>');function me(F,K){Zt(K,!1);const I=X(),O=X(),W=X(),P=X(),M=X(),bt=X();let V=ee(K,"items",8);const Z=60,T=800,S=8,st=40,Q=90,gt=10,at=1.2,rt=25,_t=6;function it(e){return e.title!==void 0&&e.published!==void 0}function C(e){return(e-t(I))*at+Z}function L(e){return e===0?"0":e<0?`${Math.abs(e)}BC`:`${e}`}let l=X(null),lt=X(0),ct=X(0),j=!1,xt=0,wt=0,yt=0,kt=0,h,tt=0,Mt=1,ht=1;Vt(()=>{if(h=document.querySelector(".timeline-container"),h){const n=Math.max(0,C(500)-h.clientWidth/2);h.scrollLeft=n}});function Rt(e){e.target.closest(".person-bar, .book-dot, .person-name, .book-title, .image-popup")||(t(l)&&m(l,null),j=!0,xt=e.pageX-h.offsetLeft,wt=e.pageY-h.offsetTop,yt=h.scrollLeft,kt=h.scrollTop,h.style.cursor="grabbing")}function Bt(e){if(!j)return;e.preventDefault();const n=e.pageX-h.offsetLeft,a=e.pageY-h.offsetTop,o=(n-xt)*1.5,r=(a-wt)*1.5;h.scrollLeft=yt-o,h.scrollTop=kt-r}function Ft(){j=!1,h&&(h.style.cursor="grab")}function Ot(){j&&(j=!1,h&&(h.style.cursor="grab"))}function Tt(e){const n=e[0].clientX-e[1].clientX,a=e[0].clientY-e[1].clientY;return Math.sqrt(n*n+a*a)}function Wt(e){e.touches.length===2&&(e.preventDefault(),tt=Tt(e.touches),Mt=ht)}function Ct(e){if(e.touches.length===2&&tt>0){e.preventDefault();const a=Tt(e.touches)/tt;ht=Math.max(.5,Math.min(3,Mt*a));const r=h==null?void 0:h.querySelector(".timeline-content");r&&(r.style.transform=`scale(${ht})`,r.style.transformOrigin="center center")}}function Lt(e){e.touches.length<2&&(tt=0)}function Yt(e,n){m(l,e);const a=Pt(n.clientX,n.clientY);m(lt,a.x),m(ct,a.y),n.stopPropagation()}function Dt(e,n){if(n.key==="Enter"||n.key===" "){n.preventDefault(),m(l,e);const a=n.target.getBoundingClientRect(),o=Pt(a.left+a.width/2,a.top+a.height/2);m(lt,o.x),m(ct,o.y)}}function Pt(e,n){const a={width:220,height:300},o=20;let r=e,i=n;return r+a.width/2>window.innerWidth-o&&(r=window.innerWidth-a.width/2-o),r-a.width/2<o&&(r=a.width/2+o),i+a.height/2>window.innerHeight-o&&(i=window.innerHeight-a.height/2-o),i-a.height/2<o&&(i=a.height/2+o),{x:r,y:i}}z(()=>ut(V()),()=>{m(I,Math.floor(Math.min(...V().map(e=>e.born||e.published||0))/100)*100-100)}),z(()=>ut(V()),()=>{m(O,Math.ceil(Math.max(...V().map(e=>e.died||new Date().getFullYear()||0))/100)*100)}),z(()=>(t(O),t(I)),()=>{m(W,(t(O)-t(I))*at+Z*2)}),z(()=>{},()=>{m(P,T+Z*3+rt*2*(S+st))}),z(()=>ut(V()),()=>{m(M,[...V()].sort((e,n)=>(e.born||e.published||0)-(n.born||n.published||0)))}),z(()=>(t(O),t(I)),()=>{m(bt,Array.from({length:Math.ceil((t(O)-t(I))/100)+1},(e,n)=>Math.floor(t(I)/100)*100+n*100))}),z(()=>t(M),()=>{const e=[],n=[];for(let o=0;o<t(M).length;o++)o%2===0?(e.push(t(M)[o]),Et(M,t(M)[o].placement="top")):(n.push(t(M)[o]),Et(M,t(M)[o].placement="bottom"));function a(o){o.sort((r,i)=>(r.born||r.published||0)-(i.born||i.published||0));for(let r=0;r<o.length;r++){const i=o[r],$=i.born||i.published||0,q=i.died||new Date().getFullYear();let A=!1,p=1;for(;!A&&p<=rt;)o.some((u,f)=>{var b,H;if(f>=r||u.row!==p)return!1;const w=u.born||u.published||0,v=u.died||new Date().getFullYear();if(it(i)&&it(u)){const D=(((b=i.title)==null?void 0:b.length)||0)*6,_=(((H=u.title)==null?void 0:H.length)||0)*6,E=Math.max(D,_),N=Math.max(50,E/at);return Math.abs($-w)<N}return $<=v+70&&q>=w-70})?p++:(i.row=p,A=!0);A||(i.row=rt)}}a(e),a(n)}),jt(),Kt();var Y=ie(),et=y(Y),nt=y(et),dt=y(nt),St=g(dt);Xt(St,1,()=>t(bt),It,(e,n)=>{var a=ne(),o=ft(a);s(o,"y1",0);var r=g(o);s(r,"y",T-20);var i=y(r,!0);k(r),G(($,q,A,p)=>{s(o,"x1",$),s(o,"x2",q),s(o,"y2",t(P)),s(r,"x",A),U(i,p)},[()=>C(t(n)),()=>C(t(n)),()=>C(t(n)),()=>L(t(n))],d),B(e,a)});var J=g(St);s(J,"x1",Z),s(J,"y1",T),s(J,"y2",T);var qt=g(J);Xt(qt,1,()=>t(M),It,(e,n)=>{var a=Gt();const o=d(()=>t(n).born||t(n).published||0),r=d(()=>it(t(n))),i=d(()=>t(r)?t(n).title:t(n).name);var $=ft(a);{var q=p=>{var c=oe();const u=d(()=>C(t(o))),f=d(()=>t(n).placement==="top"),w=d(()=>(t(n).row-1)*(S+st)),v=d(()=>t(f)?T-Q-t(w)-S/2:T+Q+t(w)+S/2);var b=y(c),H=y(b,!0);k(b);var D=g(b);s(D,"r",_t);var _=g(D);k(c),G(E=>{s(c,"aria-label",`${t(i)??""} by ${t(n).author??""}, published ${E??""}`),s(b,"x",t(u)),s(b,"y",t(v)+(t(f)?-16:gt+6)),U(H,t(i)),s(D,"cx",t(u)),s(D,"cy",t(v)),s(_,"x1",t(u)),s(_,"y1",t(v)+(t(f)?_t:-6)),s(_,"x2",t(u)),s(_,"y2",T+(t(f)?-3:3))},[()=>L(t(o))],d),x("click",c,E=>Yt(t(n),E)),x("keydown",c,E=>Dt(t(n),E)),B(p,c)},A=p=>{var c=se();const u=d(()=>t(n).died||new Date().getFullYear()),f=d(()=>C(t(o))),w=d(()=>C(t(u))),v=d(()=>Math.max(t(w)-t(f),5)),b=d(()=>t(n).placement==="top"),H=d(()=>(t(n).row-1)*(S+st)),D=d(()=>t(b)?T-Q-t(H)-S:T+Q+t(H));var _=y(c),E=y(_,!0);k(_);var N=g(_);s(N,"height",S);var ot=g(N);k(c),G((R,zt)=>{s(c,"aria-label",`${t(i)??""}, ${R??""} to ${zt??""}`),s(_,"x",t(f)+t(v)/2),s(_,"y",t(D)+(t(b)?-10:S+gt)),U(E,t(i)),s(N,"x",t(f)),s(N,"y",t(D)),s(N,"width",t(v)),s(ot,"x1",t(f)+t(v)/2),s(ot,"y1",t(D)+(t(b)?S:0)),s(ot,"x2",t(f)+t(v)/2),s(ot,"y2",T+(t(b)?-3:3))},[()=>{var R;return(R=t(l))!=null&&R.born?L(t(n).born):""},()=>t(n).died?L(t(n).died):"present"],d),x("click",c,R=>Yt(t(n),R)),x("keydown",c,R=>Dt(t(n),R)),B(p,c)};pt($,p=>{t(r)?p(q):p(A,!1)})}B(e,a)}),k(nt),k(et);var Ht=g(et,2);{var Nt=e=>{var n=re(),a=y(n),o=g(a,2),r=y(o,!0);k(o);var i=g(o,2),$=y(i);{var q=c=>{var u=ae(),f=ft(u,!0),w=g(f,2);G(v=>{U(f,t(l).author),U(w,` ${v??""}`)},[()=>L(t(l).published)],d),B(c,u)},A=c=>{var u=Ut();G((f,w,v)=>U(u,`${f??""} - 
          ${w??""}
          (${v??""} years)`),[()=>t(l).born?L(t(l).born):"",()=>t(l).died?L(t(l).died):"present",()=>t(l).died?Math.abs(t(l).died-t(l).born):Math.abs(new Date().getFullYear()-t(l).born)],d),B(c,u)};pt($,c=>{t(l).title?c(q):c(A,!1)})}k(i);var p=g(i,2);k(n),G(c=>{$t(n,`left: ${t(lt)??""}px; top: ${t(ct)??""}px;`),s(a,"src",c),s(a,"alt",t(l).name||t(l).title),U(r,t(l).name||t(l).title)},[()=>te(t(l).image)],d),x("click",p,()=>m(l,null)),B(e,n)};pt(Ht,e=>{t(l)&&e(Nt)})}k(Y),G(()=>{$t(et,`width: ${t(W)??""}px; height: ${t(P)??""}px;`),s(nt,"width",t(W)),s(nt,"height",t(P)),s(dt,"width",t(W)),s(dt,"height",t(P)),s(J,"x2",t(W)-Z)}),x("mousedown",Y,Rt),x("mousemove",Y,Bt),x("mouseup",Y,Ft),x("mouseleave",Y,Ot),x("touchstart",Y,Wt),x("touchmove",Y,Ct),x("touchend",Y,Lt),B(F,Y),Jt()}export{me as T};
