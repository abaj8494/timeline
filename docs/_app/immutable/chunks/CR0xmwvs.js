import{t as he,a as S,n as ue,c as Le,b as Ce}from"./BIYvNW0b.js";import{i as We}from"./14nf3aC0.js";import{h as Te,p as Ge,o as He,a0 as H,a1 as Ne,X as N,a as qe,G as g,I as A,T as ce,x as e,a2 as Pe,Y as _,_ as b,Z as m,W as pe,u as p}from"./CSOfU5Pt.js";import{e as E,s as q}from"./vckkWNzg.js";import{i as de}from"./DBxt3fiE.js";import{t as ze,e as Ae,s as r,i as Ee,r as Ue}from"./vHPMZuXj.js";import{p as Ke}from"./BWVsNKEK.js";function De($,z,D,B){var F=$.__style;if(Te||F!==z){var Y=ze(z);(!Te||Y!==$.getAttribute("style"))&&(Y==null?$.removeAttribute("style"):$.style.cssText=Y),$.__style=z}return B}var Ve=ue('<line class="time-marker-line svelte-13gc2pw"></line><text text-anchor="middle" class="time-marker svelte-13gc2pw"> </text>',1),Ze=ue('<g role="button" tabindex="0" class="svelte-13gc2pw"><text text-anchor="middle" class="book-title svelte-13gc2pw"> </text><circle class="book-dot svelte-13gc2pw"></circle><line stroke="#555" stroke-width="0.5" stroke-dasharray="2 2"></line></g>'),je=ue('<g role="button" tabindex="0" class="svelte-13gc2pw"><text text-anchor="middle" class="person-name svelte-13gc2pw"> </text><rect class="person-bar svelte-13gc2pw"></rect><line stroke="#555" stroke-width="0.5" stroke-dasharray="2 2"></line></g>'),Je=he(" <br> ",1),Qe=he('<div class="image-popup svelte-13gc2pw"><img class="svelte-13gc2pw"> <h4 class="svelte-13gc2pw"> </h4> <p class="svelte-13gc2pw"><!></p> <button style="position: absolute; top: 5px; right: 5px; background: none; border: none; color: white; cursor: pointer; font-size: 16px;">Ã—</button></div>'),et=he('<div class="timeline-container svelte-13gc2pw" role="application" aria-label="Interactive timeline visualization - click and drag to pan"><div class="timeline-content svelte-13gc2pw"><svg class="svelte-13gc2pw"><rect x="0" y="0" fill="#17191C"></rect><!><line class="main-timeline svelte-13gc2pw"></line><!></svg></div> <!></div>');function lt($,z){Ge(z,!1);const D=A(),B=A(),F=A(),Y=A(),x=A(),fe=A();let U=Ke(z,"items",8);const K=60,y=800,T=8,oe=40,J=90,ve=10,ge=1.2,re=25,be=6;function ae(s){return s.title!==void 0&&s.published!==void 0}function O(s){return(s-e(D))*ge+K}function L(s){return s===0?"0":s<0?`${Math.abs(s)}BC`:`${s}`}let c=A(null),ne=A(0),ie=A(0),V=!1,we=0,_e=0,me=0,xe=0,h;He(()=>{if(h=document.querySelector(".timeline-container"),h){const t=Math.max(0,O(500)-h.clientWidth/2);h.scrollLeft=t}});function Ie(s){s.target.closest(".person-bar, .book-dot, .person-name, .book-title, .image-popup")||(V=!0,we=s.pageX-h.offsetLeft,_e=s.pageY-h.offsetTop,me=h.scrollLeft,xe=h.scrollTop,h.style.cursor="grabbing")}function Re(s){if(!V)return;s.preventDefault();const t=s.pageX-h.offsetLeft,a=s.pageY-h.offsetTop,o=(t-we)*1.5,i=(a-_e)*1.5;h.scrollLeft=me-o,h.scrollTop=xe-i}function Xe(){V=!1,h&&(h.style.cursor="grab")}function Se(){V&&(V=!1,h&&(h.style.cursor="grab"))}function ye(s,t){g(c,s);const a=Me(t.clientX,t.clientY);g(ne,a.x),g(ie,a.y),t.stopPropagation()}function ke(s,t){if(t.key==="Enter"||t.key===" "){t.preventDefault(),g(c,s);const a=t.target.getBoundingClientRect(),o=Me(a.left+a.width/2,a.top+a.height/2);g(ne,o.x),g(ie,o.y)}}function Me(s,t){const a={width:220,height:300},o=20;let i=s,n=t;return i+a.width/2>window.innerWidth-o&&(i=window.innerWidth-a.width/2-o),i-a.width/2<o&&(i=a.width/2+o),n+a.height/2>window.innerHeight-o&&(n=window.innerHeight-a.height/2-o),n-a.height/2<o&&(n=a.height/2+o),{x:i,y:n}}H(()=>ce(U()),()=>{g(D,Math.floor(Math.min(...U().map(s=>s.born||s.published||0))/100)*100-100)}),H(()=>ce(U()),()=>{g(B,Math.ceil(Math.max(...U().map(s=>s.died||new Date().getFullYear()||0))/100)*100)}),H(()=>(e(B),e(D)),()=>{g(F,(e(B)-e(D))*ge+K*2)}),H(()=>{},()=>{g(Y,y+K*3+re*2*(T+oe))}),H(()=>ce(U()),()=>{g(x,[...U()].sort((s,t)=>(s.born||s.published||0)-(t.born||t.published||0)))}),H(()=>(e(B),e(D)),()=>{g(fe,Array.from({length:Math.ceil((e(B)-e(D))/100)+1},(s,t)=>Math.floor(e(D)/100)*100+t*100))}),H(()=>e(x),()=>{const s=[],t=[];for(let o=0;o<e(x).length;o++)o%2===0?(s.push(e(x)[o]),Pe(x,e(x)[o].placement="top")):(t.push(e(x)[o]),Pe(x,e(x)[o].placement="bottom"));function a(o){o.sort((i,n)=>(i.born||i.published||0)-(n.born||n.published||0));for(let i=0;i<o.length;i++){const n=o[i],I=n.born||n.published||0,W=n.died||new Date().getFullYear();let P=!1,f=1;for(;!P&&f<=re;)o.some((d,u)=>{if(u>=i||d.row!==f)return!1;const w=d.born||d.published||0,v=d.died||new Date().getFullYear();return ae(n)&&ae(d)?Math.abs(I-w)<30:I<=v+70&&W>=w-70})?f++:(n.row=f,P=!0);P||(n.row=re)}}a(s),a(t)}),Ne(),We();var C=et(),Q=_(C),ee=_(Q),le=_(ee),Ye=b(le);Ae(Ye,1,()=>e(fe),Ee,(s,t)=>{var a=Ve(),o=pe(a);r(o,"y1",0);var i=b(o);r(i,"y",y-20);var n=_(i,!0);m(i),N((I,W,P,f)=>{r(o,"x1",I),r(o,"x2",W),r(o,"y2",e(Y)),r(i,"x",P),q(n,f)},[()=>O(e(t)),()=>O(e(t)),()=>O(e(t)),()=>L(e(t))],p),S(s,a)});var Z=b(Ye);r(Z,"x1",K),r(Z,"y1",y),r(Z,"y2",y);var $e=b(Z);Ae($e,1,()=>e(x),Ee,(s,t)=>{var a=Le();const o=p(()=>e(t).born||e(t).published||0),i=p(()=>ae(e(t))),n=p(()=>e(i)?e(t).title:e(t).name);var I=pe(a);{var W=f=>{var l=Ze();const d=p(()=>O(e(o))),u=p(()=>e(t).placement==="top"),w=p(()=>(e(t).row-1)*(T+oe)),v=p(()=>e(u)?y-J-e(w)-T/2:y+J+e(w)+T/2);var k=_(l),te=_(k,!0);m(k);var R=b(k);r(R,"r",be);var M=b(R);m(l),N(G=>{r(l,"aria-label",`${e(n)??""} by ${e(t).author??""}, published ${G??""}`),r(k,"x",e(d)),r(k,"y",e(v)+(e(u)?-16:ve+6)),q(te,e(n)),r(R,"cx",e(d)),r(R,"cy",e(v)),r(M,"x1",e(d)),r(M,"y1",e(v)+(e(u)?be:-6)),r(M,"x2",e(d)),r(M,"y2",y+(e(u)?-3:3))},[()=>L(e(o))],p),E("click",l,G=>ye(e(t),G)),E("keydown",l,G=>ke(e(t),G)),S(f,l)},P=f=>{var l=je();const d=p(()=>e(t).died||new Date().getFullYear()),u=p(()=>O(e(o))),w=p(()=>O(e(d))),v=p(()=>Math.max(e(w)-e(u),5)),k=p(()=>e(t).placement==="top"),te=p(()=>(e(t).row-1)*(T+oe)),R=p(()=>e(k)?y-J-e(te)-T:y+J+e(te));var M=_(l),G=_(M,!0);m(M);var j=b(M);r(j,"height",T);var se=b(j);m(l),N((X,Oe)=>{r(l,"aria-label",`${e(n)??""}, ${X??""} to ${Oe??""}`),r(M,"x",e(u)+e(v)/2),r(M,"y",e(R)+(e(k)?-10:T+ve)),q(G,e(n)),r(j,"x",e(u)),r(j,"y",e(R)),r(j,"width",e(v)),r(se,"x1",e(u)+e(v)/2),r(se,"y1",e(R)+(e(k)?T:0)),r(se,"x2",e(u)+e(v)/2),r(se,"y2",y+(e(k)?-3:3))},[()=>{var X;return(X=e(c))!=null&&X.born?L(e(t).born):""},()=>e(t).died?L(e(t).died):"present"],p),E("click",l,X=>ye(e(t),X)),E("keydown",l,X=>ke(e(t),X)),S(f,l)};de(I,f=>{e(i)?f(W):f(P,!1)})}S(s,a)}),m(ee),m(Q);var Be=b(Q,2);{var Fe=s=>{var t=Qe(),a=_(t),o=b(a,2),i=_(o,!0);m(o);var n=b(o,2),I=_(n);{var W=l=>{var d=Je(),u=pe(d,!0),w=b(u,2);N(v=>{q(u,e(c).author),q(w,` ${v??""}`)},[()=>L(e(c).published)],p),S(l,d)},P=l=>{var d=Ce();N((u,w,v)=>q(d,`${u??""} - 
          ${w??""}
          (${v??""} years)`),[()=>e(c).born?L(e(c).born):"",()=>e(c).died?L(e(c).died):"present",()=>e(c).died?Math.abs(e(c).died-e(c).born):Math.abs(new Date().getFullYear()-e(c).born)],p),S(l,d)};de(I,l=>{e(c).title?l(W):l(P,!1)})}m(n);var f=b(n,2);m(t),N(l=>{De(t,`left: ${e(ne)??""}px; top: ${e(ie)??""}px;`),r(a,"src",l),r(a,"alt",e(c).name||e(c).title),q(i,e(c).name||e(c).title)},[()=>Ue(e(c).image)],p),E("click",f,()=>g(c,null)),S(s,t)};de(Be,s=>{e(c)&&s(Fe)})}m(C),N(()=>{De(Q,`width: ${e(F)??""}px; height: ${e(Y)??""}px;`),r(ee,"width",e(F)),r(ee,"height",e(Y)),r(le,"width",e(F)),r(le,"height",e(Y)),r(Z,"x2",e(F)-K)}),E("mousedown",C,Ie),E("mousemove",C,Re),E("mouseup",C,Xe),E("mouseleave",C,Se),S($,C),qe()}export{lt as T};
