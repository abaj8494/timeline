import{t as de,a as R,n as ge,c as je,b as Je}from"./tV2K8-t_.js";import{i as Qe}from"./ByiRlZ4K.js";import{o as et}from"./uz48rOOJ.js";import{v as $e,p as tt,a3 as Z,a4 as nt,_ as L,a as ot,k as m,m as C,X as be,c as e,a5 as Be,$ as M,a1 as v,a0 as D,Z as le,d as c}from"./WXaAkZrh.js";import{e as x,s as O}from"./F6O-0aNN.js";import{i as ie}from"./Bj7JGMQR.js";import{a as at,e as Re,s as r,i as Ce,r as rt}from"./DK-BLzrm.js";import{p as st}from"./B3nBOueu.js";function ce(N,j,W,H){var G=N.__style;if($e||G!==j){var F=at(j);(!$e||F!==N.getAttribute("style"))&&(F==null?N.removeAttribute("style"):N.style.cssText=F),N.__style=j}return H}var lt=ge('<line class="time-marker-line svelte-179nmnb"></line><text text-anchor="middle" class="time-marker svelte-179nmnb"> </text>',1),it=ge('<g role="button" tabindex="0" class="svelte-179nmnb"><text text-anchor="middle" class="book-title svelte-179nmnb"> </text><circle class="book-dot svelte-179nmnb"></circle><line stroke="#555" stroke-width="0.5" stroke-dasharray="2 2"></line></g>'),ct=ge('<g role="button" tabindex="0" class="svelte-179nmnb"><text text-anchor="middle" class="person-name svelte-179nmnb"> </text><rect class="person-bar svelte-179nmnb"></rect><line stroke="#555" stroke-width="0.5" stroke-dasharray="2 2"></line></g>'),dt=de(" <br> ",1),ht=de(" <br> ",1),ut=de('<div class="image-popup svelte-179nmnb"><img class="svelte-179nmnb"> <h4 class="svelte-179nmnb"> </h4> <p class="svelte-179nmnb"><!></p> <button style="position: absolute; top: 5px; right: 5px; background: none; border: none; color: white; cursor: pointer; font-size: 16px;">Ã—</button></div>'),ft=de('<div class="timeline-container svelte-179nmnb" role="application" aria-label="Interactive timeline visualization - click and drag to pan, hold Ctrl/Cmd and scroll to zoom, pinch to zoom on mobile"><div class="timeline-content svelte-179nmnb"><svg class="svelte-179nmnb"><rect x="0" y="0" fill="#17191C"></rect><!><line class="main-timeline svelte-179nmnb"></line><!></svg></div> <!></div>');function wt(N,j){tt(j,!1);const W=C(),H=C(),G=C(),F=C(),Y=C(),_e=C();let J=st(j,"items",8);const ee=60,T=800,P=8,he=40,oe=90,xe=10,ue=1.2,fe=25,ye=6;function we(t){return t.title!==void 0&&t.published!==void 0}function ke(t){return t.title!==void 0&&t.created!==void 0}function Me(t){return we(t)||ke(t)}function K(t){return(t-e(W))*ue+ee}function V(t){return t===0?"0":t<0?`${Math.abs(t)}BC`:`${t}`}let i=C(null),pe=C(0),me=C(0),te=!1,De=0,Ye=0,Te=0,Se=0,d,ae=0,Ae=1,Q=1;et(()=>{if(d=document.querySelector(".timeline-container"),d){const n=Math.max(0,K(500)-d.clientWidth/2);d.scrollLeft=n}});function Oe(t){t.target.closest(".person-bar, .book-dot, .person-name, .book-title, .image-popup")||(e(i)&&m(i,null),te=!0,De=t.pageX-d.offsetLeft,Ye=t.pageY-d.offsetTop,Te=d.scrollLeft,Se=d.scrollTop,d.style.cursor="grabbing")}function We(t){if(!te)return;t.preventDefault();const n=t.pageX-d.offsetLeft,a=t.pageY-d.offsetTop,o=(n-De)*1.5,l=(a-Ye)*1.5;d.scrollLeft=Te-o,d.scrollTop=Se-l}function qe(){te=!1,d&&(d.style.cursor="grab")}function ze(){te&&(te=!1,d&&(d.style.cursor="grab"))}function Le(t){if(t.ctrlKey||t.metaKey){t.preventDefault();const o=1+-t.deltaY*.001;Q=Math.max(.5,Math.min(3,Q*o));const s=d==null?void 0:d.querySelector(".timeline-content");s&&(s.style.transform=`scale(${Q})`,s.style.transformOrigin="center center")}}function Ee(t){const n=t[0].clientX-t[1].clientX,a=t[0].clientY-t[1].clientY;return Math.sqrt(n*n+a*a)}function Ne(t){t.touches.length===2&&(t.preventDefault(),ae=Ee(t.touches),Ae=Q)}function He(t){if(t.touches.length===2&&ae>0){t.preventDefault();const a=Ee(t.touches)/ae;Q=Math.max(.5,Math.min(3,Ae*a));const l=d==null?void 0:d.querySelector(".timeline-content");l&&(l.style.transform=`scale(${Q})`,l.style.transformOrigin="center center")}}function Ge(t){t.touches.length<2&&(ae=0)}function Fe(t,n){m(i,t);const a=Ie(n.clientX,n.clientY);m(pe,a.x),m(me,a.y),n.stopPropagation()}function Pe(t,n){if(n.key==="Enter"||n.key===" "){n.preventDefault(),m(i,t);const a=n.target.getBoundingClientRect(),o=Ie(a.left+a.width/2,a.top+a.height/2);m(pe,o.x),m(me,o.y)}}function Ie(t,n){const a={width:220,height:300},o=20;let l=t,s=n;return l+a.width/2>window.innerWidth-o&&(l=window.innerWidth-a.width/2-o),l-a.width/2<o&&(l=a.width/2+o),s+a.height/2>window.innerHeight-o&&(s=window.innerHeight-a.height/2-o),s-a.height/2<o&&(s=a.height/2+o),{x:l,y:s}}Z(()=>be(J()),()=>{m(W,Math.floor(Math.min(...J().map(t=>t.born||t.published||t.created||0))/100)*100-100)}),Z(()=>be(J()),()=>{m(H,Math.ceil(Math.max(...J().map(t=>t.died||t.created||t.published||new Date().getFullYear()||0))/100)*100)}),Z(()=>(e(H),e(W)),()=>{m(G,(e(H)-e(W))*ue+ee*2)}),Z(()=>{},()=>{m(F,T+ee*3+fe*2*(P+he))}),Z(()=>be(J()),()=>{m(Y,[...J()].sort((t,n)=>(t.born||t.published||t.created||0)-(n.born||n.published||n.created||0)))}),Z(()=>(e(H),e(W)),()=>{m(_e,Array.from({length:Math.ceil((e(H)-e(W))/100)+1},(t,n)=>Math.floor(e(W)/100)*100+n*100))}),Z(()=>e(Y),()=>{const t=[],n=[];for(let o=0;o<e(Y).length;o++)o%2===0?(t.push(e(Y)[o]),Be(Y,e(Y)[o].placement="top")):(n.push(e(Y)[o]),Be(Y,e(Y)[o].placement="bottom"));function a(o){o.sort((l,s)=>(l.born||l.published||l.created||0)-(s.born||s.published||s.created||0));for(let l=0;l<o.length;l++){const s=o[l],I=s.born||s.published||s.created||0,X=s.died||s.created||s.published||new Date().getFullYear();let $=!1,S=1;for(;!$&&S<=fe;)o.some((h,f)=>{var g,p;if(f>=l||h.row!==S)return!1;const b=h.born||h.published||h.created||0,u=h.died||h.created||h.published||new Date().getFullYear();if(Me(s)&&Me(h)){const _=(((g=s.title)==null?void 0:g.length)||0)*6,A=(((p=h.title)==null?void 0:p.length)||0)*6,y=Math.max(_,A),B=Math.max(50,y/ue);return Math.abs(I-b)<B}return I<=u+70&&X>=b-70})?S++:(s.row=S,$=!0);$||(s.row=fe)}}a(t),a(n)}),nt(),Qe();var w=ft(),re=M(w),se=M(re),ve=M(se),Xe=v(ve);Re(Xe,1,()=>e(_e),Ce,(t,n)=>{var a=lt(),o=le(a);r(o,"y1",0);var l=v(o);r(l,"y",T-20);var s=M(l,!0);D(l),L((I,X,$,S)=>{r(o,"x1",I),r(o,"x2",X),r(o,"y2",e(F)),r(l,"x",$),O(s,S)},[()=>K(e(n)),()=>K(e(n)),()=>K(e(n)),()=>V(e(n))],c),R(t,a)});var ne=v(Xe);r(ne,"x1",ee),r(ne,"y1",T),r(ne,"y2",T);var Ke=v(ne);Re(Ke,1,()=>e(Y),Ce,(t,n)=>{var a=je();const o=c(()=>e(n).born||e(n).published||e(n).created||0),l=c(()=>we(e(n))),s=c(()=>ke(e(n))),I=c(()=>e(l)||e(s)),X=c(()=>e(I)?e(n).title:e(n).name);var $=le(a);{var S=h=>{var f=it();const b=c(()=>K(e(o))),u=c(()=>e(n).placement==="top"),g=c(()=>(e(n).row-1)*(P+he)),p=c(()=>e(u)?T-oe-e(g)-P/2:T+oe+e(g)+P/2),_=c(()=>e(s)?"#FF6B9D":"#4A9EFF"),A=c(()=>e(s)?"{displayName} by {item.artist}, created {formatYear(yearValue)}":"{displayName} by {item.author}, published {formatYear(yearValue)}");var y=M(f),B=M(y,!0);D(y);var U=v(y);r(U,"r",ye);var E=v(U);D(f),L(()=>{r(f,"aria-label",e(A)),r(y,"x",e(b)),r(y,"y",e(p)+(e(u)?-16:xe+6)),ce(y,`fill: ${e(s)?"#FF6B9D":"#4A9EFF"}`),O(B,e(X)),r(U,"cx",e(b)),r(U,"cy",e(p)),ce(U,`fill: ${e(_)??""}; stroke: ${e(_)??""}`),r(E,"x1",e(b)),r(E,"y1",e(p)+(e(u)?ye:-6)),r(E,"x2",e(b)),r(E,"y2",T+(e(u)?-3:3))}),x("click",f,q=>Fe(e(n),q)),x("keydown",f,q=>Pe(e(n),q)),R(h,f)},k=h=>{var f=ct();const b=c(()=>e(n).died||new Date().getFullYear()),u=c(()=>K(e(o))),g=c(()=>K(e(b))),p=c(()=>Math.max(e(g)-e(u),5)),_=c(()=>e(n).placement==="top"),A=c(()=>(e(n).row-1)*(P+he)),y=c(()=>e(_)?T-oe-e(A)-P:T+oe+e(A));var B=M(f),U=M(B,!0);D(B);var E=v(B);r(E,"height",P);var q=v(E);D(f),L((z,Ze)=>{r(f,"aria-label",`${e(X)??""}, ${z??""} to ${Ze??""}`),r(B,"x",e(u)+e(p)/2),r(B,"y",e(y)+(e(_)?-10:P+xe)),O(U,e(X)),r(E,"x",e(u)),r(E,"y",e(y)),r(E,"width",e(p)),r(q,"x1",e(u)+e(p)/2),r(q,"y1",e(y)+(e(_)?P:0)),r(q,"x2",e(u)+e(p)/2),r(q,"y2",T+(e(_)?-3:3))},[()=>{var z;return(z=e(i))!=null&&z.born?V(e(n).born):""},()=>e(n).died?V(e(n).died):"present"],c),x("click",f,z=>Fe(e(n),z)),x("keydown",f,z=>Pe(e(n),z)),R(h,f)};ie($,h=>{e(I)?h(S):h(k,!1)})}R(t,a)}),D(se),D(re);var Ve=v(re,2);{var Ue=t=>{var n=ut(),a=M(n),o=v(a,2),l=M(o,!0);D(o);var s=v(o,2),I=M(s);{var X=k=>{var h=dt(),f=le(h,!0),b=v(f,2);L(u=>{O(f,e(i).artist),O(b,` ${u??""}`)},[()=>V(e(i).created)],c),R(k,h)},$=(k,h)=>{{var f=u=>{var g=ht(),p=le(g,!0),_=v(p,2);L(A=>{O(p,e(i).author),O(_,` ${A??""}`)},[()=>V(e(i).published)],c),R(u,g)},b=u=>{var g=Je();L((p,_,A)=>O(g,`${p??""} - 
          ${_??""}
          (${A??""} years)`),[()=>e(i).born?V(e(i).born):"",()=>e(i).died?V(e(i).died):"present",()=>e(i).died?Math.abs(e(i).died-e(i).born):Math.abs(new Date().getFullYear()-e(i).born)],c),R(u,g)};ie(k,u=>{e(i).published?u(f):u(b,!1)},h)}};ie(I,k=>{e(i).created?k(X):k($,!1)})}D(s);var S=v(s,2);D(n),L(k=>{ce(n,`left: ${e(pe)??""}px; top: ${e(me)??""}px;`),r(a,"src",k),r(a,"alt",e(i).name||e(i).title),O(l,e(i).name||e(i).title)},[()=>rt(e(i).image)],c),x("click",S,()=>m(i,null)),R(t,n)};ie(Ve,t=>{e(i)&&t(Ue)})}D(w),L(()=>{ce(re,`width: ${e(G)??""}px; height: ${e(F)??""}px;`),r(se,"width",e(G)),r(se,"height",e(F)),r(ve,"width",e(G)),r(ve,"height",e(F)),r(ne,"x2",e(G)-ee)}),x("mousedown",w,Oe),x("mousemove",w,We),x("mouseup",w,qe),x("mouseleave",w,ze),x("wheel",w,Le),x("touchstart",w,Ne),x("touchmove",w,He),x("touchend",w,Ge),R(N,w),ot()}export{wt as T};
