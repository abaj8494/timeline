import{t as ht,a as $,n as _t,c as te,b as ee}from"./CB0lZw64.js";import{i as ne}from"./36iwJYuS.js";import{p as oe,o as ae,T as z,V as re,W as N,a as se,m as c,n as g,e as t,Z as xt,_ as $t,Y as E,X as b,$ as F,a0 as lt,d}from"./EIGgl-ut.js";import{e as k,s as C}from"./CBrunzHD.js";import{i as ct}from"./BZLUw1rn.js";import{e as Ct,s as r,i as Ht}from"./D4v_2-DL.js";import{s as dt}from"./pGJnAfzQ.js";import{p as ie}from"./bkRm03nm.js";import{r as le}from"./BXGdsMKA.js";var ce=_t('<line class="time-marker-line svelte-18o6i9k"></line><text text-anchor="middle" class="time-marker svelte-18o6i9k"> </text>',1),de=_t('<g role="button" tabindex="0" class="svelte-18o6i9k"><text text-anchor="middle" class="book-title svelte-18o6i9k"> </text><circle class="book-dot svelte-18o6i9k"></circle><line stroke="#555" stroke-width="0.5" stroke-dasharray="2 2"></line></g>'),he=_t('<g role="button" tabindex="0" class="svelte-18o6i9k"><text text-anchor="middle" class="person-name svelte-18o6i9k"> </text><rect class="person-bar svelte-18o6i9k"></rect><line stroke="#555" stroke-width="0.5" stroke-dasharray="2 2"></line></g>'),ue=ht(" <br> ",1),fe=ht(" <br> ",1),pe=ht('<div class="image-popup svelte-18o6i9k"><img class="svelte-18o6i9k"> <h4 class="svelte-18o6i9k"> </h4> <p class="svelte-18o6i9k"><!></p> <button style="position: absolute; top: 5px; right: 5px; background: none; border: none; color: white; cursor: pointer; font-size: 16px;">Ã—</button></div>'),ve=ht('<div class="timeline-container svelte-18o6i9k" role="application" aria-label="Interactive timeline visualization - click and drag to pan, scroll to zoom, pinch to zoom on mobile"><div class="timeline-content svelte-18o6i9k"><svg class="svelte-18o6i9k"><rect x="0" y="0" fill="#17191C"></rect><!><line class="main-timeline svelte-18o6i9k"></line><!></svg></div> <!></div>');function Ye(Ot,wt){oe(wt,!1);const q=g(),L=g(),ot=g(),U=g(),S=g(),kt=g(),Q=g();let K=ie(wt,"items",8);const tt=60,X=800,B=8,ut=40,at=90,yt=10,ft=1.2,pt=25,Mt=6;function Yt(e){return e.title!==void 0&&e.published!==void 0}function Dt(e){return e.title!==void 0&&e.created!==void 0}function Pt(e){return Yt(e)||Dt(e)}function Z(e){return(e-t(q))*ft+tt}function V(e){return e===0?"0":e<0?`${Math.abs(e)}BC`:`${e}`}let l=g(null),vt=g(0),mt=g(0),et=!1,Tt=0,At=0,j=g(0),J=g(0),Et=0,Ft=0,p=null,rt=0,St=1,m=g(1),gt=g(0);ae(()=>{if(p=document.querySelector(".timeline-container"),p){c(gt,p.clientWidth),p.clientHeight;const e=p.clientWidth/t(Q),n=p.clientHeight/t(U),a=Math.min(e,n)*.9;c(m,Math.max(.3,Math.min(10,a)));const o=t(Q)*t(m),i=t(U)*t(m);c(j,(p.clientWidth-o)/2),c(J,(p.clientHeight-i)/2)}});function zt(e){e.target.closest(".person-bar, .book-dot, .person-name, .book-title, .image-popup")||(t(l)&&c(l,null),et=!0,Tt=e.clientX,At=e.clientY,Et=t(j),Ft=t(J),p&&(p.style.cursor="grabbing"))}function Nt(e){if(!et)return;e.preventDefault();const n=e.clientX-Tt,a=e.clientY-At;c(j,Et+n),c(J,Ft+a)}function qt(){et=!1,p&&(p.style.cursor="grab")}function Vt(){et&&(et=!1,p&&(p.style.cursor="grab"))}function Gt(e){e.preventDefault();const o=1+-e.deltaY*.002,i=Math.max(.1,Math.min(20,t(m)*o));if(i!==t(m))if(p){const s=p.getBoundingClientRect(),y=e.clientX-s.left,M=e.clientY-s.top,T=(y-t(j))/t(m),Y=(M-t(J))/t(m);c(m,i),c(j,y-T*t(m)),c(J,M-Y*t(m))}else c(m,i)}function Xt(e){const n=e[0].clientX-e[1].clientX,a=e[0].clientY-e[1].clientY;return Math.sqrt(n*n+a*a)}function Ut(e){e.touches.length===2&&(e.preventDefault(),rt=Xt(e.touches),St=t(m))}function Kt(e){if(e.touches.length===2&&rt>0){e.preventDefault();const a=Xt(e.touches)/rt;c(m,Math.max(.1,Math.min(20,St*a)))}}function Zt(e){e.touches.length<2&&(rt=0)}function It(e,n){c(l,e);const a=Bt(n.clientX,n.clientY);c(vt,a.x),c(mt,a.y),n.stopPropagation()}function Wt(e,n){if(n.key==="Enter"||n.key===" "){n.preventDefault(),c(l,e);const a=n.target.getBoundingClientRect(),o=Bt(a.left+a.width/2,a.top+a.height/2);c(vt,o.x),c(mt,o.y)}}function Bt(e,n){const a={width:220,height:300},o=20;let i=e,s=n;return i+a.width/2>window.innerWidth-o&&(i=window.innerWidth-a.width/2-o),i-a.width/2<o&&(i=a.width/2+o),s+a.height/2>window.innerHeight-o&&(s=window.innerHeight-a.height/2-o),s-a.height/2<o&&(s=a.height/2+o),{x:i,y:s}}z(()=>xt(K()),()=>{c(q,Math.floor(Math.min(...K().map(e=>e.born||e.published||e.created||0))/100)*100-100)}),z(()=>xt(K()),()=>{c(L,Math.ceil(Math.max(...K().map(e=>e.died||e.created||e.published||new Date().getFullYear()||0))/100)*100)}),z(()=>(t(L),t(q)),()=>{c(ot,(t(L)-t(q))*ft+tt*2)}),z(()=>{},()=>{c(U,X+tt*3+pt*2*(B+ut))}),z(()=>xt(K()),()=>{c(S,[...K()].sort((e,n)=>(e.born||e.published||e.created||0)-(n.born||n.published||n.created||0)))}),z(()=>(t(L),t(q)),()=>{c(kt,Array.from({length:Math.ceil((t(L)-t(q))/100)+1},(e,n)=>Math.floor(t(q)/100)*100+n*100))}),z(()=>t(S),()=>{const e=[],n=[];for(let o=0;o<t(S).length;o++)o%2===0?(e.push(t(S)[o]),$t(S,t(S)[o].placement="top")):(n.push(t(S)[o]),$t(S,t(S)[o].placement="bottom"));function a(o){o.sort((i,s)=>(i.born||i.published||i.created||0)-(s.born||s.published||s.created||0));for(let i=0;i<o.length;i++){const s=o[i],y=s.born||s.published||s.created||0,M=s.died||s.created||s.published||new Date().getFullYear();let T=!1,Y=1;for(;!T&&Y<=pt;)o.some((h,f)=>{var _,v;if(f>=i||h.row!==Y)return!1;const x=h.born||h.published||h.created||0,u=h.died||h.created||h.published||new Date().getFullYear();if(Pt(s)&&Pt(h)){const w=(((_=s.title)==null?void 0:_.length)||0)*6,I=(((v=h.title)==null?void 0:v.length)||0)*6,D=Math.max(w,I),R=Math.max(50,D/ft);return Math.abs(y-x)<R}return y<=u+70&&M>=x-70})?Y++:(s.row=Y,T=!0);T||(s.row=pt)}}a(e),a(n)}),z(()=>(t(ot),t(gt)),()=>{c(Q,Math.max(t(ot),t(gt)/.5))}),re(),ne();var P=ve(),st=E(P),it=E(st),bt=E(it),Rt=b(bt);Ct(Rt,1,()=>t(kt),Ht,(e,n)=>{var a=ce(),o=lt(a);r(o,"y1",0);var i=b(o);r(i,"y",X-20);var s=E(i,!0);F(i),N((y,M,T,Y)=>{r(o,"x1",y),r(o,"x2",M),r(o,"y2",t(U)),r(i,"x",T),C(s,Y)},[()=>Z(t(n)),()=>Z(t(n)),()=>Z(t(n)),()=>V(t(n))],d),$(e,a)});var nt=b(Rt);r(nt,"x1",tt),r(nt,"y1",X),r(nt,"y2",X);var jt=b(nt);Ct(jt,1,()=>t(S),Ht,(e,n)=>{var a=te();const o=d(()=>t(n).born||t(n).published||t(n).created||0),i=d(()=>Yt(t(n))),s=d(()=>Dt(t(n))),y=d(()=>t(i)||t(s)),M=d(()=>t(y)?t(n).title:t(n).name);var T=lt(a);{var Y=h=>{var f=de();const x=d(()=>Z(t(o))),u=d(()=>t(n).placement==="top"),_=d(()=>(t(n).row-1)*(B+ut)),v=d(()=>t(u)?X-at-t(_)-B/2:X+at+t(_)+B/2),w=d(()=>t(s)?"#FF6B9D":"#4A9EFF"),I=d(()=>t(s)?"{displayName} by {item.artist}, created {formatYear(yearValue)}":"{displayName} by {item.author}, published {formatYear(yearValue)}");var D=E(f),R=E(D,!0);F(D);var G=b(D);r(G,"r",Mt);var W=b(G);F(f),N(()=>{r(f,"aria-label",t(I)),r(D,"x",t(x)),r(D,"y",t(v)+(t(u)?-16:yt+6)),dt(D,`fill: ${t(s)?"#FF6B9D":"#4A9EFF"}`),C(R,t(M)),r(G,"cx",t(x)),r(G,"cy",t(v)),dt(G,`fill: ${t(w)??""}; stroke: ${t(w)??""}`),r(W,"x1",t(x)),r(W,"y1",t(v)+(t(u)?Mt:-6)),r(W,"x2",t(x)),r(W,"y2",X+(t(u)?-3:3))}),k("click",f,H=>It(t(n),H)),k("keydown",f,H=>Wt(t(n),H)),$(h,f)},A=h=>{var f=he();const x=d(()=>t(n).died||new Date().getFullYear()),u=d(()=>Z(t(o))),_=d(()=>Z(t(x))),v=d(()=>Math.max(t(_)-t(u),5)),w=d(()=>t(n).placement==="top"),I=d(()=>(t(n).row-1)*(B+ut)),D=d(()=>t(w)?X-at-t(I)-B:X+at+t(I));var R=E(f),G=E(R,!0);F(R);var W=b(R);r(W,"height",B);var H=b(W);F(f),N((O,Qt)=>{r(f,"aria-label",`${t(M)??""}, ${O??""} to ${Qt??""}`),r(R,"x",t(u)+t(v)/2),r(R,"y",t(D)+(t(w)?-10:B+yt)),C(G,t(M)),r(W,"x",t(u)),r(W,"y",t(D)),r(W,"width",t(v)),r(H,"x1",t(u)+t(v)/2),r(H,"y1",t(D)+(t(w)?B:0)),r(H,"x2",t(u)+t(v)/2),r(H,"y2",X+(t(w)?-3:3))},[()=>{var O;return(O=t(l))!=null&&O.born?V(t(n).born):""},()=>t(n).died?V(t(n).died):"present"],d),k("click",f,O=>It(t(n),O)),k("keydown",f,O=>Wt(t(n),O)),$(h,f)};ct(T,h=>{t(y)?h(Y):h(A,!1)})}$(e,a)}),F(it),F(st);var Jt=b(st,2);{var Lt=e=>{var n=pe(),a=E(n),o=b(a,2),i=E(o,!0);F(o);var s=b(o,2),y=E(s);{var M=A=>{var h=ue(),f=lt(h,!0),x=b(f,2);N(u=>{C(f,t(l).artist),C(x,` ${u??""}`)},[()=>V(t(l).created)],d),$(A,h)},T=(A,h)=>{{var f=u=>{var _=fe(),v=lt(_,!0),w=b(v,2);N(I=>{C(v,t(l).author),C(w,` ${I??""}`)},[()=>V(t(l).published)],d),$(u,_)},x=u=>{var _=ee();N((v,w,I)=>C(_,`${v??""} -
					${w??""}
					(${I??""} years)`),[()=>t(l).born?V(t(l).born):"",()=>t(l).died?V(t(l).died):"present",()=>t(l).died?Math.abs(t(l).died-t(l).born):Math.abs(new Date().getFullYear()-t(l).born)],d),$(u,_)};ct(A,u=>{t(l).published?u(f):u(x,!1)},h)}};ct(y,A=>{t(l).created?A(M):A(T,!1)})}F(s);var Y=b(s,2);F(n),N(A=>{dt(n,`left: ${t(vt)??""}px; top: ${t(mt)??""}px;`),r(a,"src",A),r(a,"alt",t(l).name||t(l).title),C(i,t(l).name||t(l).title)},[()=>le(t(l).image)],d),k("click",Y,()=>c(l,null)),$(e,n)};ct(Jt,e=>{t(l)&&e(Lt)})}F(P),N(()=>{dt(st,`transform: translate(${t(j)??""}px, ${t(J)??""}px) scale(${t(m)??""}); transform-origin: 0 0;`),r(it,"width",t(Q)),r(it,"height",t(U)),r(bt,"width",t(Q)),r(bt,"height",t(U)),r(nt,"x2",t(ot)-tt)}),k("mousedown",P,zt),k("mousemove",P,Nt),k("mouseup",P,qt),k("mouseleave",P,Vt),k("wheel",P,Gt),k("touchstart",P,Ut),k("touchmove",P,Kt),k("touchend",P,Zt),$(Ot,P),se()}export{Ye as T};
