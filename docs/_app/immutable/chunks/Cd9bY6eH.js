import{t as he,a as $,n as fe,c as Le,b as Ce}from"./tV2K8-t_.js";import{i as He}from"./ByiRlZ4K.js";import{o as Ne}from"./uz48rOOJ.js";import{v as Pe,p as We,a3 as W,a4 as Ge,_ as G,a as qe,k as g,m as A,X as ce,c as e,a5 as Te,$ as _,a1 as b,a0 as m,Z as pe,d as p}from"./WXaAkZrh.js";import{e as E,s as q}from"./F6O-0aNN.js";import{i as de}from"./Bj7JGMQR.js";import{a as ze,e as Ae,s as r,i as Ee,r as Ue}from"./B3iS5x3d.js";import{p as Ke}from"./B3nBOueu.js";function De(S,z,D,B){var F=S.__style;if(Pe||F!==z){var Y=ze(z);(!Pe||Y!==S.getAttribute("style"))&&(Y==null?S.removeAttribute("style"):S.style.cssText=Y),S.__style=z}return B}var Ve=fe('<line class="time-marker-line svelte-13gc2pw"></line><text text-anchor="middle" class="time-marker svelte-13gc2pw"> </text>',1),Ze=fe('<g role="button" tabindex="0" class="svelte-13gc2pw"><text text-anchor="middle" class="book-title svelte-13gc2pw"> </text><circle class="book-dot svelte-13gc2pw"></circle><line stroke="#555" stroke-width="0.5" stroke-dasharray="2 2"></line></g>'),je=fe('<g role="button" tabindex="0" class="svelte-13gc2pw"><text text-anchor="middle" class="person-name svelte-13gc2pw"> </text><rect class="person-bar svelte-13gc2pw"></rect><line stroke="#555" stroke-width="0.5" stroke-dasharray="2 2"></line></g>'),Je=he(" <br> ",1),Qe=he('<div class="image-popup svelte-13gc2pw"><img class="svelte-13gc2pw"> <h4 class="svelte-13gc2pw"> </h4> <p class="svelte-13gc2pw"><!></p> <button style="position: absolute; top: 5px; right: 5px; background: none; border: none; color: white; cursor: pointer; font-size: 16px;">Ã—</button></div>'),et=he('<div class="timeline-container svelte-13gc2pw" role="application" aria-label="Interactive timeline visualization - click and drag to pan"><div class="timeline-content svelte-13gc2pw"><svg class="svelte-13gc2pw"><rect x="0" y="0" fill="#17191C"></rect><!><line class="main-timeline svelte-13gc2pw"></line><!></svg></div> <!></div>');function ct(S,z){We(z,!1);const D=A(),B=A(),F=A(),Y=A(),x=A(),ue=A();let U=Ke(z,"items",8);const K=60,y=800,P=8,se=40,J=90,ve=10,ge=1.2,re=25,be=6;function ae(o){return o.title!==void 0&&o.published!==void 0}function O(o){return(o-e(D))*ge+K}function L(o){return o===0?"0":o<0?`${Math.abs(o)}BC`:`${o}`}let c=A(null),ne=A(0),ie=A(0),V=!1,we=0,_e=0,me=0,xe=0,h;Ne(()=>{if(h=document.querySelector(".timeline-container"),h){const t=Math.max(0,O(500)-h.clientWidth/2);h.scrollLeft=t}});function Ie(o){o.target.closest(".person-bar, .book-dot, .person-name, .book-title, .image-popup")||(V=!0,we=o.pageX-h.offsetLeft,_e=o.pageY-h.offsetTop,me=h.scrollLeft,xe=h.scrollTop,h.style.cursor="grabbing")}function Re(o){if(!V)return;o.preventDefault();const t=o.pageX-h.offsetLeft,a=o.pageY-h.offsetTop,s=(t-we)*1.5,i=(a-_e)*1.5;h.scrollLeft=me-s,h.scrollTop=xe-i}function Xe(){V=!1,h&&(h.style.cursor="grab")}function $e(){V&&(V=!1,h&&(h.style.cursor="grab"))}function ye(o,t){g(c,o);const a=Me(t.clientX,t.clientY);g(ne,a.x),g(ie,a.y),t.stopPropagation()}function ke(o,t){if(t.key==="Enter"||t.key===" "){t.preventDefault(),g(c,o);const a=t.target.getBoundingClientRect(),s=Me(a.left+a.width/2,a.top+a.height/2);g(ne,s.x),g(ie,s.y)}}function Me(o,t){const a={width:220,height:300},s=20;let i=o,n=t;return i+a.width/2>window.innerWidth-s&&(i=window.innerWidth-a.width/2-s),i-a.width/2<s&&(i=a.width/2+s),n+a.height/2>window.innerHeight-s&&(n=window.innerHeight-a.height/2-s),n-a.height/2<s&&(n=a.height/2+s),{x:i,y:n}}W(()=>ce(U()),()=>{g(D,Math.floor(Math.min(...U().map(o=>o.born||o.published||0))/100)*100-100)}),W(()=>ce(U()),()=>{g(B,Math.ceil(Math.max(...U().map(o=>o.died||new Date().getFullYear()||0))/100)*100)}),W(()=>(e(B),e(D)),()=>{g(F,(e(B)-e(D))*ge+K*2)}),W(()=>{},()=>{g(Y,y+K*3+re*2*(P+se))}),W(()=>ce(U()),()=>{g(x,[...U()].sort((o,t)=>(o.born||o.published||0)-(t.born||t.published||0)))}),W(()=>(e(B),e(D)),()=>{g(ue,Array.from({length:Math.ceil((e(B)-e(D))/100)+1},(o,t)=>Math.floor(e(D)/100)*100+t*100))}),W(()=>e(x),()=>{const o=[],t=[];for(let s=0;s<e(x).length;s++)s%2===0?(o.push(e(x)[s]),Te(x,e(x)[s].placement="top")):(t.push(e(x)[s]),Te(x,e(x)[s].placement="bottom"));function a(s){s.sort((i,n)=>(i.born||i.published||0)-(n.born||n.published||0));for(let i=0;i<s.length;i++){const n=s[i],I=n.born||n.published||0,H=n.died||new Date().getFullYear();let T=!1,u=1;for(;!T&&u<=re;)s.some((d,f)=>{if(f>=i||d.row!==u)return!1;const w=d.born||d.published||0,v=d.died||new Date().getFullYear();return ae(n)&&ae(d)?Math.abs(I-w)<30:I<=v+70&&H>=w-70})?u++:(n.row=u,T=!0);T||(n.row=re)}}a(o),a(t)}),Ge(),He();var C=et(),Q=_(C),ee=_(Q),le=_(ee),Ye=b(le);Ae(Ye,1,()=>e(ue),Ee,(o,t)=>{var a=Ve(),s=pe(a);r(s,"y1",0);var i=b(s);r(i,"y",y-20);var n=_(i,!0);m(i),G((I,H,T,u)=>{r(s,"x1",I),r(s,"x2",H),r(s,"y2",e(Y)),r(i,"x",T),q(n,u)},[()=>O(e(t)),()=>O(e(t)),()=>O(e(t)),()=>L(e(t))],p),$(o,a)});var Z=b(Ye);r(Z,"x1",K),r(Z,"y1",y),r(Z,"y2",y);var Se=b(Z);Ae(Se,1,()=>e(x),Ee,(o,t)=>{var a=Le();const s=p(()=>e(t).born||e(t).published||0),i=p(()=>ae(e(t))),n=p(()=>e(i)?e(t).title:e(t).name);var I=pe(a);{var H=u=>{var l=Ze();const d=p(()=>O(e(s))),f=p(()=>e(t).placement==="top"),w=p(()=>(e(t).row-1)*(P+se)),v=p(()=>e(f)?y-J-e(w)-P/2:y+J+e(w)+P/2);var k=_(l),te=_(k,!0);m(k);var R=b(k);r(R,"r",be);var M=b(R);m(l),G(N=>{r(l,"aria-label",`${e(n)??""} by ${e(t).author??""}, published ${N??""}`),r(k,"x",e(d)),r(k,"y",e(v)+(e(f)?-16:ve+6)),q(te,e(n)),r(R,"cx",e(d)),r(R,"cy",e(v)),r(M,"x1",e(d)),r(M,"y1",e(v)+(e(f)?be:-6)),r(M,"x2",e(d)),r(M,"y2",y+(e(f)?-3:3))},[()=>L(e(s))],p),E("click",l,N=>ye(e(t),N)),E("keydown",l,N=>ke(e(t),N)),$(u,l)},T=u=>{var l=je();const d=p(()=>e(t).died||new Date().getFullYear()),f=p(()=>O(e(s))),w=p(()=>O(e(d))),v=p(()=>Math.max(e(w)-e(f),5)),k=p(()=>e(t).placement==="top"),te=p(()=>(e(t).row-1)*(P+se)),R=p(()=>e(k)?y-J-e(te)-P:y+J+e(te));var M=_(l),N=_(M,!0);m(M);var j=b(M);r(j,"height",P);var oe=b(j);m(l),G((X,Oe)=>{r(l,"aria-label",`${e(n)??""}, ${X??""} to ${Oe??""}`),r(M,"x",e(f)+e(v)/2),r(M,"y",e(R)+(e(k)?-10:P+ve)),q(N,e(n)),r(j,"x",e(f)),r(j,"y",e(R)),r(j,"width",e(v)),r(oe,"x1",e(f)+e(v)/2),r(oe,"y1",e(R)+(e(k)?P:0)),r(oe,"x2",e(f)+e(v)/2),r(oe,"y2",y+(e(k)?-3:3))},[()=>{var X;return(X=e(c))!=null&&X.born?L(e(t).born):""},()=>e(t).died?L(e(t).died):"present"],p),E("click",l,X=>ye(e(t),X)),E("keydown",l,X=>ke(e(t),X)),$(u,l)};de(I,u=>{e(i)?u(H):u(T,!1)})}$(o,a)}),m(ee),m(Q);var Be=b(Q,2);{var Fe=o=>{var t=Qe(),a=_(t),s=b(a,2),i=_(s,!0);m(s);var n=b(s,2),I=_(n);{var H=l=>{var d=Je(),f=pe(d,!0),w=b(f,2);G(v=>{q(f,e(c).author),q(w,` ${v??""}`)},[()=>L(e(c).published)],p),$(l,d)},T=l=>{var d=Ce();G((f,w,v)=>q(d,`${f??""} - 
          ${w??""}
          (${v??""} years)`),[()=>e(c).born?L(e(c).born):"",()=>e(c).died?L(e(c).died):"present",()=>e(c).died?Math.abs(e(c).died-e(c).born):Math.abs(new Date().getFullYear()-e(c).born)],p),$(l,d)};de(I,l=>{e(c).title?l(H):l(T,!1)})}m(n);var u=b(n,2);m(t),G(l=>{De(t,`left: ${e(ne)??""}px; top: ${e(ie)??""}px;`),r(a,"src",l),r(a,"alt",e(c).name||e(c).title),q(i,e(c).name||e(c).title)},[()=>Ue(e(c).image)],p),E("click",u,()=>g(c,null)),$(o,t)};de(Be,o=>{e(c)&&o(Fe)})}m(C),G(()=>{De(Q,`width: ${e(F)??""}px; height: ${e(Y)??""}px;`),r(ee,"width",e(F)),r(ee,"height",e(Y)),r(le,"width",e(F)),r(le,"height",e(Y)),r(Z,"x2",e(F)-K)}),E("mousedown",C,Ie),E("mousemove",C,Re),E("mouseup",C,Xe),E("mouseleave",C,$e),$(S,C),qe()}export{ct as T};
