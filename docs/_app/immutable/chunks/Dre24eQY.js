import{t as z,a as W,c as oe,n as kt}from"./CB0lZw64.js";import{i as re}from"./36iwJYuS.js";import{p as ae,o as ie,T as k,V as ce,W as P,a as le,X as M,Y as E,m as c,n as _,e as t,Z as rt,_ as Ot,$ as T,a0 as mt,d as F}from"./EIGgl-ut.js";import{e as I,s as N}from"./CBrunzHD.js";import{i as Q}from"./BZLUw1rn.js";import{e as vt,s as l,i as pt}from"./XRJWPJde.js";import{s as gt}from"./XGydMKRX.js";import{p as Wt}from"./bkRm03nm.js";var de=kt('<line class="time-marker-line svelte-1mf97ri"></line><text text-anchor="middle" class="time-marker svelte-1mf97ri"> </text>',1),fe=kt('<g role="button" tabindex="0" class="svelte-1mf97ri"><text text-anchor="middle" class="event-label svelte-1mf97ri"> </text><rect rx="3" ry="3" class="event-bar svelte-1mf97ri"></rect><line stroke="#555" stroke-width="0.5" stroke-dasharray="2 2"></line></g>'),ue=z('<p class="subtitle svelte-1mf97ri"> </p>'),he=z("<br> ",1),me=z('<span class="tag svelte-1mf97ri"> </span>'),ve=z('<div class="tags svelte-1mf97ri"></div>'),pe=z('<div class="event-popup svelte-1mf97ri"><button class="close-btn svelte-1mf97ri">Ã—</button> <h4 class="svelte-1mf97ri"> </h4> <!> <div class="time-label svelte-1mf97ri"> <!></div> <!></div>'),ge=z('<div class="event-timeline-container svelte-1mf97ri" role="application" aria-label="Interactive event timeline - click and drag to pan, scroll to zoom"><div class="timeline-content svelte-1mf97ri"><svg class="svelte-1mf97ri"><rect x="0" y="0" fill="#17191C"></rect><!><line class="main-timeline svelte-1mf97ri"></line><!></svg></div> <!></div>');function Ie(Ct,at){ae(at,!1);const y=_(),C=_(),Xt=_(),it=_(),X=_(),H=_(),A=_(),_t=_();let $=Wt(at,"items",8),tt=Wt(at,"scaleType",8,"linear");const b=60,B=500,U=12,xt=35,Mt=60,Bt=8,ct=20,Rt=4e3,Yt=4e3;let lt=_(0);const Z=-66e6,K=-2e6,G=-1e4,Pt=.15,Nt=.2,Ht=.3,$t=.35;function S(e,n=1e9){return Math.asinh(e/n)}function R(e){const n=t(X)-b*2;if(tt()==="log"){const s=n*Pt,o=n*Nt,a=n*Ht,i=n*$t;if(e<=Z){const d=S(t(y),1e8),u=S(Z,1e8),h=(S(e,1e8)-d)/(u-d);return b+h*s}else if(e<=K){const d=S(Z,1e6),u=S(K,1e6),h=(S(e,1e6)-d)/(u-d);return b+s+h*o}else if(e<=G){const d=S(K,1e4),u=S(G,1e4),h=(S(e,1e4)-d)/(u-d);return b+s+o+h*a}else{const r=(e-G)/(t(C)-G);return b+s+o+a+r*i}}else{const s=(e-t(y))/(t(C)-t(y));return b+s*n}}function Ut(){const e=[],n=t(C)-t(y);if(tt()==="log"){const s=[-138e8,-45e8,-38e8,-541e6,-252e6,-66e6];for(const r of s)r>=t(y)&&r<=Z&&e.push(r);const o=[-5e7,-2e7,-1e7,-5e6,-2e6];for(const r of o)r>Z&&r<=K&&e.push(r);const a=[-15e5,-1e6,-5e5,-2e5,-1e5,-5e4,-2e4,-1e4];for(const r of a)r>K&&r<=G&&e.push(r);const i=[-8e3,-5e3,-3e3,-2e3,-1e3,-500,0,500,1e3,1500,2e3];for(const r of i)r>G&&r<=t(C)&&e.push(r)}else{let s;n>1e4?s=2e3:n>5e3?s=1e3:n>1e3?s=500:n>500?s=100:s=50;const o=Math.ceil(t(y)/s)*s;for(let a=o;a<=t(C);a+=s)e.push(a)}return e.sort((s,o)=>s-o)}function yt(e){const n=Math.abs(e);if(n>=1e9)return`${(e/1e9).toFixed(1)} Ga`;if(n>=1e6)return`${(e/1e6).toFixed(1)} Ma`;if(n>=1e3){const s=Math.abs(e).toLocaleString();return e<0?`${s} BC`:`${s} AD`}else return e<0?`${Math.abs(e)} BC`:`${e} AD`}let m=_(null),dt=_(0),ft=_(0),V=!1,bt=0,Tt=0,L=_(0),q=_(0),wt=0,Et=0,p=null,et=0,It=1,x=_(1);ie(()=>{if(p=document.querySelector(".event-timeline-container"),p){c(lt,p.clientWidth);const e=p.clientWidth/t(X),n=p.clientHeight/t(H),s=Math.min(e,n)*.9;c(x,Math.max(.3,Math.min(10,s)));const o=t(X)*t(x),a=t(H)*t(x);c(L,(p.clientWidth-o)/2),c(q,(p.clientHeight-a)/2)}});function Gt(e){e.target.closest(".event-bar, .event-label, .event-popup")||(t(m)&&c(m,null),V=!0,bt=e.clientX,Tt=e.clientY,wt=t(L),Et=t(q),p&&(p.style.cursor="grabbing"))}function Lt(e){if(!V)return;e.preventDefault();const n=e.clientX-bt,s=e.clientY-Tt;c(L,wt+n),c(q,Et+s)}function qt(){V=!1,p&&(p.style.cursor="grab")}function zt(){V&&(V=!1,p&&(p.style.cursor="grab"))}function Zt(e){e.preventDefault();const o=1+-e.deltaY*.002,a=Math.max(.1,Math.min(20,t(x)*o));if(a!==t(x))if(p){const i=p.getBoundingClientRect(),r=e.clientX-i.left,d=e.clientY-i.top,u=(r-t(L))/t(x),g=(d-t(q))/t(x);c(x,a),c(L,r-u*t(x)),c(q,d-g*t(x))}else c(x,a)}function At(e){const n=e[0].clientX-e[1].clientX,s=e[0].clientY-e[1].clientY;return Math.sqrt(n*n+s*s)}function Kt(e){e.touches.length===2&&(e.preventDefault(),et=At(e.touches),It=t(x))}function Vt(e){if(e.touches.length===2&&et>0){e.preventDefault();const s=At(e.touches)/et;c(x,Math.max(.1,Math.min(20,It*s)))}}function jt(e){e.touches.length<2&&(et=0)}function Jt(e,n){c(m,e);const s=Dt(n.clientX,n.clientY);c(dt,s.x),c(ft,s.y),n.stopPropagation()}function Qt(e,n){if(n.key==="Enter"||n.key===" "){n.preventDefault(),c(m,e);const s=n.target.getBoundingClientRect(),o=Dt(s.left+s.width/2,s.top+s.height/2);c(dt,o.x),c(ft,o.y)}}function Dt(e,n){const s={width:300,height:200},o=20;let a=e,i=n;return a+s.width/2>window.innerWidth-o&&(a=window.innerWidth-s.width/2-o),a-s.width/2<o&&(a=s.width/2+o),i+s.height/2>window.innerHeight-o&&(i=window.innerHeight-s.height/2-o),i-s.height/2<o&&(i=s.height/2+o),{x:a,y:i}}function te(e){const n=e.tags||[];return n.includes("extinction")?"#EF4444":n.includes("war")?"#DC2626":n.includes("biology")?"#22C55E":n.includes("humanity")?"#F59E0B":n.includes("politics")?"#6366F1":n.includes("religion")||n.includes("philosophy")?"#8B5CF6":n.includes("science")||n.includes("technology")?"#3B82F6":n.includes("culture")||n.includes("art")?"#EC4899":n.includes("economy")?"#14B8A6":n.includes("cosmology")||n.includes("astronomy")||n.includes("physics")?"#06B6D4":n.includes("earth")||n.includes("chemistry")?"#84CC16":"#FA6742"}k(()=>rt($()),()=>{c(y,Math.min(...$().map(e=>e.start)))}),k(()=>rt($()),()=>{c(C,Math.max(...$().map(e=>e.end)))}),k(()=>t(y),()=>{c(Xt,t(y)<0?Math.abs(t(y))+1:0)}),k(()=>(rt(tt()),t(C),t(y)),()=>{c(it,tt()==="log"?Yt:Math.max(Rt,(t(C)-t(y))*.2))}),k(()=>(t(it),t(lt)),()=>{c(X,Math.max(t(it),t(lt)/.5)+b*4)}),k(()=>{},()=>{c(H,B+b*3+ct*2*(U+xt))}),k(()=>rt($()),()=>{c(A,[...$()].sort((e,n)=>e.start-n.start))}),k(()=>{},()=>{c(_t,Ut())}),k(()=>t(A),()=>{const e=[],n=[];for(let o=0;o<t(A).length;o++)o%2===0?(e.push(t(A)[o]),Ot(A,t(A)[o].placement="top")):(n.push(t(A)[o]),Ot(A,t(A)[o].placement="bottom"));function s(o){var a;o.sort((i,r)=>i.start-r.start);for(let i=0;i<o.length;i++){const r=o[i],d=R(r.start),u=R(r.end),g=(((a=r.title)==null?void 0:a.length)||0)*7;let h=!1,D=1;for(;!h&&D<=ct;)o.some((f,v)=>{var St;if(v>=i||f.row!==D)return!1;const Y=R(f.start),ht=R(f.end),J=(((St=f.title)==null?void 0:St.length)||0)*7,ot=80+Math.max(g,J)/2;return d<=ht+ot&&u>=Y-ot})?D++:(r.row=D,h=!0);h||(r.row=ct)}}s(e),s(n)}),ce(),re();var w=ge(),nt=E(w),st=E(nt),ut=E(st),Ft=M(ut);vt(Ft,1,()=>t(_t),pt,(e,n)=>{var s=oe();const o=F(()=>R(t(n)));var a=mt(s);{var i=r=>{var d=de(),u=mt(d);l(u,"y1",0);var g=M(u);l(g,"y",B-15);var h=E(g,!0);T(g),P(D=>{l(u,"x1",t(o)),l(u,"x2",t(o)),l(u,"y2",t(H)),l(g,"x",t(o)),N(h,D)},[()=>yt(t(n))],F),W(r,d)};Q(a,r=>{t(o)>=b&&t(o)<=t(X)-b&&r(i)})}W(e,s)});var j=M(Ft);l(j,"x1",b),l(j,"y1",B),l(j,"y2",B);var ee=M(j);vt(ee,1,()=>t(A),pt,(e,n)=>{var s=fe();const o=F(()=>R(t(n).start)),a=F(()=>R(t(n).end)),i=F(()=>Math.max(t(a)-t(o),8)),r=F(()=>t(n).placement==="top"),d=F(()=>(t(n).row-1)*(U+xt)),u=F(()=>t(r)?B-Mt-t(d)-U:B+Mt+t(d)),g=F(()=>te(t(n)));var h=E(s),D=E(h,!0);T(h);var O=M(h);l(O,"height",U);var f=M(O);T(s),P(()=>{l(s,"aria-label",t(n).title),l(h,"x",t(o)+t(i)/2),l(h,"y",t(u)+(t(r)?-8:U+Bt+4)),N(D,t(n).title),l(O,"x",t(o)),l(O,"y",t(u)),l(O,"width",t(i)),gt(O,`fill: ${t(g)??""}`),l(f,"x1",t(o)+t(i)/2),l(f,"y1",t(u)+(t(r)?U:0)),l(f,"x2",t(o)+t(i)/2),l(f,"y2",B+(t(r)?-3:3))}),I("click",s,v=>Jt(t(n),v)),I("keydown",s,v=>Qt(t(n),v)),W(e,s)}),T(st),T(nt);var ne=M(nt,2);{var se=e=>{var n=pe(),s=E(n),o=M(s,2),a=E(o,!0);T(o);var i=M(o,2);{var r=f=>{var v=ue(),Y=E(v,!0);T(v),P(()=>N(Y,t(m).subtitle)),W(f,v)};Q(i,f=>{t(m).subtitle&&f(r)})}var d=M(i,2),u=E(d),g=M(u);{var h=f=>{var v=he(),Y=M(mt(v),1,!0);P(()=>N(Y,t(m).region)),W(f,v)};Q(g,f=>{t(m).region&&f(h)})}T(d);var D=M(d,2);{var O=f=>{var v=ve();vt(v,5,()=>t(m).tags,pt,(Y,ht)=>{var J=me(),ot=E(J,!0);T(J),P(()=>N(ot,t(ht))),W(Y,J)}),T(v),W(f,v)};Q(D,f=>{t(m).tags&&t(m).tags.length>0&&f(O)})}T(n),P(f=>{gt(n,`left: ${t(dt)??""}px; top: ${t(ft)??""}px;`),N(a,t(m).title),N(u,`${f??""} `)},[()=>t(m).labelTime||yt(t(m).start)],F),I("click",s,()=>c(m,null)),W(e,n)};Q(ne,e=>{t(m)&&e(se)})}T(w),P(()=>{gt(nt,`transform: translate(${t(L)??""}px, ${t(q)??""}px) scale(${t(x)??""}); transform-origin: 0 0;`),l(st,"width",t(X)),l(st,"height",t(H)),l(ut,"width",t(X)),l(ut,"height",t(H)),l(j,"x2",t(X)-b)}),I("mousedown",w,Gt),I("mousemove",w,Lt),I("mouseup",w,qt),I("mouseleave",w,zt),I("wheel",w,Zt),I("touchstart",w,Kt),I("touchmove",w,Vt),I("touchend",w,jt),W(Ct,w),le()}export{Ie as E};
