import{t as U,a as k,c as te,n as kt}from"./CB0lZw64.js";import{i as ee}from"./36iwJYuS.js";import{p as ne,o as se,T as A,V as ae,W as O,a as re,X as x,Y as T,m as o,n as p,e as t,Z as nt,_ as St,$ as M,a0 as dt,d as S}from"./EIGgl-ut.js";import{e as E,s as R}from"./CBrunzHD.js";import{i as V}from"./BZLUw1rn.js";import{e as ht,s as l,i as vt}from"./D4v_2-DL.js";import{s as mt}from"./pGJnAfzQ.js";import{p as Wt}from"./bkRm03nm.js";var ie=kt('<line class="time-marker-line svelte-1mf97ri"></line><text text-anchor="middle" class="time-marker svelte-1mf97ri"> </text>',1),oe=kt('<g role="button" tabindex="0" class="svelte-1mf97ri"><text text-anchor="middle" class="event-label svelte-1mf97ri"> </text><rect rx="3" ry="3" class="event-bar svelte-1mf97ri"></rect><line stroke="#555" stroke-width="0.5" stroke-dasharray="2 2"></line></g>'),le=U('<p class="subtitle svelte-1mf97ri"> </p>'),ce=U("<br> ",1),ue=U('<span class="tag svelte-1mf97ri"> </span>'),fe=U('<div class="tags svelte-1mf97ri"></div>'),de=U('<div class="event-popup svelte-1mf97ri"><button class="close-btn svelte-1mf97ri">Ã—</button> <h4 class="svelte-1mf97ri"> </h4> <!> <div class="time-label svelte-1mf97ri"> <!></div> <!></div>'),he=U('<div class="event-timeline-container svelte-1mf97ri" role="application" aria-label="Interactive event timeline - click and drag to pan, scroll to zoom"><div class="timeline-content svelte-1mf97ri"><svg class="svelte-1mf97ri"><rect x="0" y="0" fill="#17191C"></rect><!><line class="main-timeline svelte-1mf97ri"></line><!></svg></div> <!></div>');function Me(At,st){ne(st,!1);const y=p(),I=p(),It=p(),at=p(),B=p(),N=p(),D=p(),pt=p();let $=Wt(st,"items",8),j=Wt(st,"scaleType",8,"linear");const X=60,Y=500,H=12,gt=35,_t=60,Bt=8,rt=20,Yt=4e3,Ft=4e3;let it=p(0);const G=-66e6,Pt=.25,Ot=.75;function ot(e,n=1e9){return Math.asinh(e/n)}function F(e){const n=t(B)-X*2;if(j()==="log"){const s=n*Pt,a=n*Ot;if(e<=G){const i=ot(t(y),1e8),c=ot(G,1e8),f=(ot(e,1e8)-i)/(c-i);return X+f*s}else{const r=(e-G)/(t(I)-G);return X+s+r*a}}else{const s=(e-t(y))/(t(I)-t(y));return X+s*n}}function Rt(){const e=[],n=t(I)-t(y);if(j()==="log"){const s=[-138e8,-45e8,-38e8,-25e8,-541e6,-252e6,-66e6];for(const r of s)r>=t(y)&&r<=G&&e.push(r);const a=[-5e7,-2e7,-1e7,-5e6,-2e6,-5e5,-1e5,-1e4,-5e3,0,1e3,2e3];for(const r of a)r>G&&r<=t(I)&&e.push(r)}else{let s;n>1e4?s=2e3:n>5e3?s=1e3:n>1e3?s=500:n>500?s=100:s=50;const a=Math.ceil(t(y)/s)*s;for(let r=a;r<=t(I);r+=s)e.push(r)}return e.sort((s,a)=>s-a)}function xt(e){const n=Math.abs(e);return n>=1e9?`${(e/1e9).toFixed(1)} Ga`:n>=1e6?`${(e/1e6).toFixed(1)} Ma`:n>=1e3?e<0?`${Math.abs(e)} BC`:`${e} AD`:e<0?`${Math.abs(e)} BC`:`${e} AD`}let d=p(null),lt=p(0),ct=p(0),Z=!1,yt=0,bt=0,q=p(0),z=p(0),Mt=0,wt=0,v=null,J=0,Tt=1,g=p(1);se(()=>{if(v=document.querySelector(".event-timeline-container"),v){o(it,v.clientWidth);const e=v.clientWidth/t(B),n=v.clientHeight/t(N),s=Math.min(e,n)*.9;o(g,Math.max(.3,Math.min(10,s)));const a=t(B)*t(g),r=t(N)*t(g);o(q,(v.clientWidth-a)/2),o(z,(v.clientHeight-r)/2)}});function Nt(e){e.target.closest(".event-bar, .event-label, .event-popup")||(t(d)&&o(d,null),Z=!0,yt=e.clientX,bt=e.clientY,Mt=t(q),wt=t(z),v&&(v.style.cursor="grabbing"))}function $t(e){if(!Z)return;e.preventDefault();const n=e.clientX-yt,s=e.clientY-bt;o(q,Mt+n),o(z,wt+s)}function Ht(){Z=!1,v&&(v.style.cursor="grab")}function Gt(){Z&&(Z=!1,v&&(v.style.cursor="grab"))}function qt(e){e.preventDefault();const a=1+-e.deltaY*.002,r=Math.max(.1,Math.min(20,t(g)*a));if(r!==t(g))if(v){const i=v.getBoundingClientRect(),c=e.clientX-i.left,m=e.clientY-i.top,f=(c-t(q))/t(g),b=(m-t(z))/t(g);o(g,r),o(q,c-f*t(g)),o(z,m-b*t(g))}else o(g,r)}function Et(e){const n=e[0].clientX-e[1].clientX,s=e[0].clientY-e[1].clientY;return Math.sqrt(n*n+s*s)}function zt(e){e.touches.length===2&&(e.preventDefault(),J=Et(e.touches),Tt=t(g))}function Ut(e){if(e.touches.length===2&&J>0){e.preventDefault();const s=Et(e.touches)/J;o(g,Math.max(.1,Math.min(20,Tt*s)))}}function Zt(e){e.touches.length<2&&(J=0)}function Kt(e,n){o(d,e);const s=Dt(n.clientX,n.clientY);o(lt,s.x),o(ct,s.y),n.stopPropagation()}function Lt(e,n){if(n.key==="Enter"||n.key===" "){n.preventDefault(),o(d,e);const s=n.target.getBoundingClientRect(),a=Dt(s.left+s.width/2,s.top+s.height/2);o(lt,a.x),o(ct,a.y)}}function Dt(e,n){const s={width:300,height:200},a=20;let r=e,i=n;return r+s.width/2>window.innerWidth-a&&(r=window.innerWidth-s.width/2-a),r-s.width/2<a&&(r=s.width/2+a),i+s.height/2>window.innerHeight-a&&(i=window.innerHeight-s.height/2-a),i-s.height/2<a&&(i=s.height/2+a),{x:r,y:i}}function Vt(e){const n=e.tags||[];return n.includes("extinction")?"#EF4444":n.includes("war")?"#DC2626":n.includes("biology")?"#22C55E":n.includes("humanity")?"#F59E0B":n.includes("politics")?"#6366F1":n.includes("religion")||n.includes("philosophy")?"#8B5CF6":n.includes("science")||n.includes("technology")?"#3B82F6":n.includes("culture")||n.includes("art")?"#EC4899":n.includes("economy")?"#14B8A6":n.includes("cosmology")||n.includes("astronomy")||n.includes("physics")?"#06B6D4":n.includes("earth")||n.includes("chemistry")?"#84CC16":"#FA6742"}A(()=>nt($()),()=>{o(y,Math.min(...$().map(e=>e.start)))}),A(()=>nt($()),()=>{o(I,Math.max(...$().map(e=>e.end)))}),A(()=>t(y),()=>{o(It,t(y)<0?Math.abs(t(y))+1:0)}),A(()=>(nt(j()),t(I),t(y)),()=>{o(at,j()==="log"?Ft:Math.max(Yt,(t(I)-t(y))*.2))}),A(()=>(t(at),t(it)),()=>{o(B,Math.max(t(at),t(it)/.5)+X*4)}),A(()=>{},()=>{o(N,Y+X*3+rt*2*(H+gt))}),A(()=>nt($()),()=>{o(D,[...$()].sort((e,n)=>e.start-n.start))}),A(()=>{},()=>{o(pt,Rt())}),A(()=>t(D),()=>{const e=[],n=[];for(let a=0;a<t(D).length;a++)a%2===0?(e.push(t(D)[a]),St(D,t(D)[a].placement="top")):(n.push(t(D)[a]),St(D,t(D)[a].placement="bottom"));function s(a){var r;a.sort((i,c)=>i.start-c.start);for(let i=0;i<a.length;i++){const c=a[i],m=F(c.start),f=F(c.end),b=(((r=c.title)==null?void 0:r.length)||0)*7;let _=!1,C=1;for(;!_&&C<=rt;)a.some((u,h)=>{var Ct;if(h>=i||u.row!==C)return!1;const P=F(u.start),ft=F(u.end),L=(((Ct=u.title)==null?void 0:Ct.length)||0)*7,et=80+Math.max(b,L)/2;return m<=ft+et&&f>=P-et})?C++:(c.row=C,_=!0);_||(c.row=rt)}}s(e),s(n)}),ae(),ee();var w=he(),Q=T(w),tt=T(Q),ut=T(tt),Xt=x(ut);ht(Xt,1,()=>t(pt),vt,(e,n)=>{var s=te();const a=S(()=>F(t(n)));var r=dt(s);{var i=c=>{var m=ie(),f=dt(m);l(f,"y1",0);var b=x(f);l(b,"y",Y-15);var _=T(b,!0);M(b),O(C=>{l(f,"x1",t(a)),l(f,"x2",t(a)),l(f,"y2",t(N)),l(b,"x",t(a)),R(_,C)},[()=>xt(t(n))],S),k(c,m)};V(r,c=>{t(a)>=X&&t(a)<=t(B)-X&&c(i)})}k(e,s)});var K=x(Xt);l(K,"x1",X),l(K,"y1",Y),l(K,"y2",Y);var jt=x(K);ht(jt,1,()=>t(D),vt,(e,n)=>{var s=oe();const a=S(()=>F(t(n).start)),r=S(()=>F(t(n).end)),i=S(()=>Math.max(t(r)-t(a),8)),c=S(()=>t(n).placement==="top"),m=S(()=>(t(n).row-1)*(H+gt)),f=S(()=>t(c)?Y-_t-t(m)-H:Y+_t+t(m)),b=S(()=>Vt(t(n)));var _=T(s),C=T(_,!0);M(_);var W=x(_);l(W,"height",H);var u=x(W);M(s),O(()=>{l(s,"aria-label",t(n).title),l(_,"x",t(a)+t(i)/2),l(_,"y",t(f)+(t(c)?-8:H+Bt+4)),R(C,t(n).title),l(W,"x",t(a)),l(W,"y",t(f)),l(W,"width",t(i)),mt(W,`fill: ${t(b)??""}`),l(u,"x1",t(a)+t(i)/2),l(u,"y1",t(f)+(t(c)?H:0)),l(u,"x2",t(a)+t(i)/2),l(u,"y2",Y+(t(c)?-3:3))}),E("click",s,h=>Kt(t(n),h)),E("keydown",s,h=>Lt(t(n),h)),k(e,s)}),M(tt),M(Q);var Jt=x(Q,2);{var Qt=e=>{var n=de(),s=T(n),a=x(s,2),r=T(a,!0);M(a);var i=x(a,2);{var c=u=>{var h=le(),P=T(h,!0);M(h),O(()=>R(P,t(d).subtitle)),k(u,h)};V(i,u=>{t(d).subtitle&&u(c)})}var m=x(i,2),f=T(m),b=x(f);{var _=u=>{var h=ce(),P=x(dt(h),1,!0);O(()=>R(P,t(d).region)),k(u,h)};V(b,u=>{t(d).region&&u(_)})}M(m);var C=x(m,2);{var W=u=>{var h=fe();ht(h,5,()=>t(d).tags,vt,(P,ft)=>{var L=ue(),et=T(L,!0);M(L),O(()=>R(et,t(ft))),k(P,L)}),M(h),k(u,h)};V(C,u=>{t(d).tags&&t(d).tags.length>0&&u(W)})}M(n),O(u=>{mt(n,`left: ${t(lt)??""}px; top: ${t(ct)??""}px;`),R(r,t(d).title),R(f,`${u??""} `)},[()=>t(d).labelTime||xt(t(d).start)],S),E("click",s,()=>o(d,null)),k(e,n)};V(Jt,e=>{t(d)&&e(Qt)})}M(w),O(()=>{mt(Q,`transform: translate(${t(q)??""}px, ${t(z)??""}px) scale(${t(g)??""}); transform-origin: 0 0;`),l(tt,"width",t(B)),l(tt,"height",t(N)),l(ut,"width",t(B)),l(ut,"height",t(N)),l(K,"x2",t(B)-X)}),E("mousedown",w,Nt),E("mousemove",w,$t),E("mouseup",w,Ht),E("mouseleave",w,Gt),E("wheel",w,qt),E("touchstart",w,zt),E("touchmove",w,Ut),E("touchend",w,Zt),k(At,w),re()}export{Me as E};
